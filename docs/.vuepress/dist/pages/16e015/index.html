<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Go Web basics | Southyang的文档库</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/apple-touch-icon-152x152.png">
    <meta name="description" content="开放式文档库，记录学习经历">
    <meta name="theme-color" content="#538ec5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/logo.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.12504bc4.css" as="style"><link rel="preload" href="/assets/js/app.7731fe9a.js" as="script"><link rel="preload" href="/assets/js/2.8135f503.js" as="script"><link rel="preload" href="/assets/js/58.ece82136.js" as="script"><link rel="preload" href="/assets/js/3.c554437f.js" as="script"><link rel="prefetch" href="/assets/js/10.091bf6c5.js"><link rel="prefetch" href="/assets/js/11.ecad1f64.js"><link rel="prefetch" href="/assets/js/12.db6baf63.js"><link rel="prefetch" href="/assets/js/13.be7ec884.js"><link rel="prefetch" href="/assets/js/14.01687950.js"><link rel="prefetch" href="/assets/js/15.f6c9075e.js"><link rel="prefetch" href="/assets/js/16.7ffa71eb.js"><link rel="prefetch" href="/assets/js/17.9f78a60c.js"><link rel="prefetch" href="/assets/js/18.40e91bac.js"><link rel="prefetch" href="/assets/js/19.2a0b1ee1.js"><link rel="prefetch" href="/assets/js/20.861fdee3.js"><link rel="prefetch" href="/assets/js/21.d6103d64.js"><link rel="prefetch" href="/assets/js/22.814ca09d.js"><link rel="prefetch" href="/assets/js/23.3ab61d22.js"><link rel="prefetch" href="/assets/js/24.5a503ba0.js"><link rel="prefetch" href="/assets/js/25.c1db428d.js"><link rel="prefetch" href="/assets/js/26.9db5b438.js"><link rel="prefetch" href="/assets/js/27.1a1478c6.js"><link rel="prefetch" href="/assets/js/28.a9a1f262.js"><link rel="prefetch" href="/assets/js/29.591c9d80.js"><link rel="prefetch" href="/assets/js/30.645d8523.js"><link rel="prefetch" href="/assets/js/31.5b064b4b.js"><link rel="prefetch" href="/assets/js/32.072eec03.js"><link rel="prefetch" href="/assets/js/33.d8c822ef.js"><link rel="prefetch" href="/assets/js/34.c843ed4d.js"><link rel="prefetch" href="/assets/js/35.9c53be72.js"><link rel="prefetch" href="/assets/js/36.08e2ece1.js"><link rel="prefetch" href="/assets/js/37.b1d8e317.js"><link rel="prefetch" href="/assets/js/38.785dc670.js"><link rel="prefetch" href="/assets/js/39.fc250894.js"><link rel="prefetch" href="/assets/js/4.b2661820.js"><link rel="prefetch" href="/assets/js/40.f7273ad5.js"><link rel="prefetch" href="/assets/js/41.61e3aef1.js"><link rel="prefetch" href="/assets/js/42.74d64a59.js"><link rel="prefetch" href="/assets/js/43.079e5097.js"><link rel="prefetch" href="/assets/js/44.d84b3513.js"><link rel="prefetch" href="/assets/js/45.c9ed6386.js"><link rel="prefetch" href="/assets/js/46.6704bca2.js"><link rel="prefetch" href="/assets/js/47.763ca35d.js"><link rel="prefetch" href="/assets/js/48.251ecc04.js"><link rel="prefetch" href="/assets/js/49.fd2ec9ed.js"><link rel="prefetch" href="/assets/js/5.40ce5b3c.js"><link rel="prefetch" href="/assets/js/50.479a6afc.js"><link rel="prefetch" href="/assets/js/51.beb8cda7.js"><link rel="prefetch" href="/assets/js/52.49791baa.js"><link rel="prefetch" href="/assets/js/53.c0a762fd.js"><link rel="prefetch" href="/assets/js/54.a1ba298d.js"><link rel="prefetch" href="/assets/js/55.7776c08a.js"><link rel="prefetch" href="/assets/js/56.0d70bcd5.js"><link rel="prefetch" href="/assets/js/57.0e37289d.js"><link rel="prefetch" href="/assets/js/59.fe7c6bc0.js"><link rel="prefetch" href="/assets/js/6.4051b925.js"><link rel="prefetch" href="/assets/js/60.90aeb701.js"><link rel="prefetch" href="/assets/js/61.0d7d6d17.js"><link rel="prefetch" href="/assets/js/62.4df6af4d.js"><link rel="prefetch" href="/assets/js/63.ba0cc296.js"><link rel="prefetch" href="/assets/js/64.f9726669.js"><link rel="prefetch" href="/assets/js/65.b66e5d62.js"><link rel="prefetch" href="/assets/js/66.e4c3114d.js"><link rel="prefetch" href="/assets/js/67.5f010b53.js"><link rel="prefetch" href="/assets/js/68.5ccacaeb.js"><link rel="prefetch" href="/assets/js/69.a9dd87cf.js"><link rel="prefetch" href="/assets/js/7.28bcc1a9.js"><link rel="prefetch" href="/assets/js/70.dac22cbb.js"><link rel="prefetch" href="/assets/js/8.ff873bdc.js"><link rel="prefetch" href="/assets/js/9.dc830684.js">
    <link rel="stylesheet" href="/assets/css/0.styles.12504bc4.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://store.southyang.cn/project/doc/logo.png" alt="Southyang的文档库" class="logo"> <span class="site-name can-hide">Southyang的文档库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="learningdoc" class="dropdown-title"><!----> <span class="title" style="display:;">学习文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learningdoc/CSAPP/" class="nav-link">CSAPP</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/TS/" class="nav-link">TS</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/Vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/Algorithm/" class="nav-link">Algorithm</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/Go/" class="nav-link">Go</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="developmentdoc" class="dropdown-title"><!----> <span class="title" style="display:;">开发文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>工程文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/developmentdoc/projectdoc/Configuration &amp; Directives/" class="nav-link">Configuration &amp; Directives</a></li><li class="dropdown-subitem"><a href="/developmentdoc/projectdoc/Debug/" class="nav-link">Debug</a></li></ul></li><li class="dropdown-item"><h4>科研文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/developmentdoc/scientificdoc/Robot/" class="nav-link">Robot</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="coursedoc" class="dropdown-title"><!----> <span class="title" style="display:;">课程文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/coursedoc/毛概/" class="nav-link">毛概</a></li><li class="dropdown-item"><!----> <a href="/coursedoc/多媒体/" class="nav-link">多媒体</a></li></ul></div></div><div class="nav-item"><a href="https://southyang.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/Southyang/Southyang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://me.southyang.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人主页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="learningdoc" class="dropdown-title"><!----> <span class="title" style="display:;">学习文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/learningdoc/CSAPP/" class="nav-link">CSAPP</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/TS/" class="nav-link">TS</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/Vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/Algorithm/" class="nav-link">Algorithm</a></li><li class="dropdown-item"><!----> <a href="/learningdoc/Go/" class="nav-link">Go</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="developmentdoc" class="dropdown-title"><!----> <span class="title" style="display:;">开发文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>工程文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/developmentdoc/projectdoc/Configuration &amp; Directives/" class="nav-link">Configuration &amp; Directives</a></li><li class="dropdown-subitem"><a href="/developmentdoc/projectdoc/Debug/" class="nav-link">Debug</a></li></ul></li><li class="dropdown-item"><h4>科研文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/developmentdoc/scientificdoc/Robot/" class="nav-link">Robot</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="coursedoc" class="dropdown-title"><!----> <span class="title" style="display:;">课程文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/coursedoc/毛概/" class="nav-link">毛概</a></li><li class="dropdown-item"><!----> <a href="/coursedoc/多媒体/" class="nav-link">多媒体</a></li></ul></div></div><div class="nav-item"><a href="https://southyang.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/Southyang/Southyang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://me.southyang.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人主页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/pages/0b600f/" class="sidebar-link">README</a></li><li><a href="/pages/648d11/" class="sidebar-link">Go basics</a></li><li><a href="/pages/16e015/" aria-current="page" class="active sidebar-link">Go Web basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/16e015/#_1-万能开头之hello-world" class="sidebar-link">1. 万能开头之Hello World</a></li><li class="sidebar-sub-header level2"><a href="/pages/16e015/#_2-简单的服务器端和客户端" class="sidebar-link">2. 简单的服务器端和客户端</a></li><li class="sidebar-sub-header level2"><a href="/pages/16e015/#_3-接受和处理go-web请求" class="sidebar-link">3. 接受和处理Go Web请求</a></li><li class="sidebar-sub-header level2"><a href="/pages/16e015/#_4-用go访问数据库" class="sidebar-link">4. 用Go访问数据库</a></li><li class="sidebar-sub-header level2"><a href="/pages/16e015/#_5-小结" class="sidebar-link">5. 小结</a></li></ul></li><li><a href="/pages/ed6347/" class="sidebar-link">Go Web Advanced</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><span data-v-0c557b5e>learningdoc</span></li><li data-v-0c557b5e><span data-v-0c557b5e>Go</span></li></ul> <div class="info" data-v-0c557b5e><!----> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2022-05-19</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Go Web basics<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="go-web基础知识"><a href="#go-web基础知识" class="header-anchor">#</a> Go Web基础知识</h1> <h2 id="_1-万能开头之hello-world"><a href="#_1-万能开头之hello-world" class="header-anchor">#</a> 1. 万能开头之Hello World</h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">hello1</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 编写hello1()函数</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Server<span class="token punctuation">{</span> <span class="token comment">// 设置端口号</span>
		Addr<span class="token punctuation">:</span> <span class="token string">&quot;0.0.0.0:80&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
    http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> hello1<span class="token punctuation">)</span> <span class="token comment">// 路由 &quot;/&quot; 对应 hello()函数</span>
	server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 监听端口</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>当我们把程序运行起来，访问<code>localhost</code>，就会在屏幕上打印出<code>Hello World</code></p> <h3 id="_1-1-小tip"><a href="#_1-1-小tip" class="header-anchor">#</a> 1.1 小Tip</h3> <p><strong>关于Web程序运行原理、请求体、请求头、session、cookie等请自行查阅其余web教程</strong></p> <h2 id="_2-简单的服务器端和客户端"><a href="#_2-简单的服务器端和客户端" class="header-anchor">#</a> 2. 简单的服务器端和客户端</h2> <h3 id="_2-1-几个小细节"><a href="#_2-1-几个小细节" class="header-anchor">#</a> 2.1 几个小细节</h3> <ul><li><p><strong>handle()是对某个资源的抽象应用，handler是异步的回调函数</strong></p></li> <li><p><strong>handler()和handlerFunc()的区别</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// http.Handle()</span>
<span class="token keyword">func</span> <span class="token function">Handle</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> handler Handler<span class="token punctuation">)</span> <span class="token punctuation">{</span> DefaultServeMux<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> handler<span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token comment">// 第二个参数是Handler这个接口, 这个接口有一个ServeHTTP()的方法</span>
<span class="token keyword">type</span> Handler <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">ServeHTTP</span><span class="token punctuation">(</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>Request<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 所以这个方法使用的时候需要自己去定义struct实现这个Handler接口。</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;log&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">type</span> httpServer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>server httpServer<span class="token punctuation">)</span> <span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> server httpServer
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>
	log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// http.HandleFunc</span>
<span class="token keyword">func</span> <span class="token function">HandleFunc</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> handler <span class="token keyword">func</span><span class="token punctuation">(</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>Request<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	DefaultServeMux<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 这个第二个参数是一个方法，参数是ResponseWriter, 和 *Request 所以使用的时候需要传方法。</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;log&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">getUrl</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> getUrl<span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p><strong>log.Fatal()和panic()的区别</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// log.Fatal()函数不会执行defer函数</span>
<span class="token comment">// panic()函数会执行完所有的defer函数，类似于java的exception</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h3 id="_2-2-创建服务器端"><a href="#_2-2-创建服务器端" class="header-anchor">#</a> 2.2 创建服务器端</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;net/http&quot;</span>

<span class="token keyword">func</span> <span class="token function">hello2</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 路由调用的函数</span>
	w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建Web服务器端两步走</span>
    http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> hello2<span class="token punctuation">)</span> <span class="token comment">// ①调用http.HandleFunc()函数，确定路由</span>
    http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token comment">// ②调用http.ListenAndServe()函数，确定并监听端口</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_2-3-制作简单的拦截器"><a href="#_2-3-制作简单的拦截器" class="header-anchor">#</a> 2.3 制作简单的拦截器</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
<span class="token punctuation">)</span>
<span class="token comment">// type HandlerFunc func(ResponseWriter, *Request)</span>
<span class="token comment">// 拦截器返回一个函数供调用，在这个函数里添加自己的逻辑判断即可 </span>
<span class="token comment">// h(w,r)及是调用用户自己的处理函数。h 是函数指针</span>
<span class="token keyword">func</span> <span class="token function">handleIterceptor</span><span class="token punctuation">(</span>h http<span class="token punctuation">.</span>HandlerFunc<span class="token punctuation">)</span> http<span class="token punctuation">.</span>HandlerFunc <span class="token punctuation">{</span> <span class="token comment">// 拦截器，拦截请求，检查请求referer</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;handleIterceptor&quot;</span><span class="token punctuation">)</span>
		w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;handleIterceptor\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">Referer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;localhost&quot;</span> <span class="token punctuation">{</span> <span class="token comment">// 如果请求的referer验证成功，就执行对应的逻辑函数</span>
			<span class="token function">h</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">hello3</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 对应端口的逻辑操作</span>
	w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建Web服务器端两步走</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> <span class="token function">handleIterceptor</span><span class="token punctuation">(</span>hello3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ①调用http.HandleFunc()函数，确定路由</span>
	<span class="token comment">// 用referer做请求拦截，当监听到对8080端口的访问时，做拦截，判断请求的referer是否正确</span>
	http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token comment">// ②调用http.ListenAndServe()函数，确定并监听端口</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_2-4-创建客户端并发送请求"><a href="#_2-4-创建客户端并发送请求" class="header-anchor">#</a> 2.4 创建客户端并发送请求</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;bytes&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;io&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">doGet</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// doget路由</span>
	response<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.taobao.com&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 发送get请求</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	bodyBytes<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Body<span class="token punctuation">)</span> <span class="token comment">// 读取响应体的body</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>bodyBytes<span class="token punctuation">)</span><span class="token punctuation">)</span>                  <span class="token comment">// 打印</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">doPost</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// dopost路由</span>
	url <span class="token operator">:=</span> <span class="token string">&quot;https://www.shirdon.com/comment/add&quot;</span>
	body <span class="token operator">:=</span> <span class="token string">&quot;{\&quot;userId\&quot;:1,\&quot;articleId\&quot;:1,\&quot;comment\&quot;:\&quot;这是一条评论\&quot;}&quot;</span>                                      <span class="token comment">// 设定请求参数</span>
	response<span class="token punctuation">,</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;·application/x-www-form-urlencoded&quot;</span><span class="token punctuation">,</span> bytes<span class="token punctuation">.</span><span class="token function">NewBuffer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 发送post请求</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	bodyBytes<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>bodyBytes<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">doPut</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// doput路由</span>
	url <span class="token operator">:=</span> <span class="token string">&quot;https://www.shirdon.com/comment/add&quot;</span>
	payload <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;userId\&quot;:1,\&quot;articleId\&quot;:1,\&quot;comment\&quot;:\&quot;这是一条评论\&quot;}&quot;</span><span class="token punctuation">)</span>
	request<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>     <span class="token comment">// put和delete请求没有封装好的函数，需要手动创建请求</span>
	request<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 添加请求头信息</span>
	response<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>          <span class="token comment">// 发送请求</span>

	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span>Body io<span class="token punctuation">.</span>ReadCloser<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 关闭响应体body</span>
		err <span class="token operator">:=</span> Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;关闭失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	bodyBytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>bodyBytes<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">doDelete</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// dodelete路由</span>
	url <span class="token operator">:=</span> <span class="token string">&quot;https://www.shirdon.com/comment/add&quot;</span>
	payload <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;{\&quot;userId\&quot;:1,\&quot;articleId\&quot;:1,\&quot;comment\&quot;:\&quot;这是一条评论\&quot;}&quot;</span><span class="token punctuation">)</span>
	request<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
	request<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span>
	response<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span>DefaultClient<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>

	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span>Body io<span class="token punctuation">.</span>ReadCloser<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		err <span class="token operator">:=</span> Body<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;关闭失败&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	bodyBytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>bodyBytes<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">hello</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// /hello路由</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// ①调用http.HandleFunc()函数，确定路由</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span> hello<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/doget&quot;</span><span class="token punctuation">,</span> doGet<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/dopost&quot;</span><span class="token punctuation">,</span> doPost<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/doput&quot;</span><span class="token punctuation">,</span> doPut<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/dodelete&quot;</span><span class="token punctuation">,</span> doDelete<span class="token punctuation">)</span>
	<span class="token comment">// ②调用http.ListenAndServe()函数，确定并监听端口</span>
	err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><h2 id="_3-接受和处理go-web请求"><a href="#_3-接受和处理go-web请求" class="header-anchor">#</a> 3. 接受和处理Go Web请求</h2> <h3 id="_3-1-httprouter路由包"><a href="#_3-1-httprouter路由包" class="header-anchor">#</a> 3.1 HttpRouter路由包</h3> <p><strong>我们使用<code>HttpRouter</code>这个HTTP路由包来帮助我们处理请求</strong></p> <p><strong>安装</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>go get -u github.com/julienschmidt/httprouter
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>使用：</strong></p> <ul><li>首先使用<code>httprouter.New()</code>函数生成<code>*Router</code>路由对象</li> <li>然后使用<code>GET()</code>方法<strong>注册</strong>一个适配**<code>/</code>**路径的<code>Index</code>函数</li> <li>最后将<code>*Router</code>对象作为参数传给<code>ListenAndServe()</code>函数即可启动<code>HTTP服务</code></li></ul> <h3 id="_3-2-httprouter包的基本使用"><a href="#_3-2-httprouter包的基本使用" class="header-anchor">#</a> 3.2 HttpRouter包的基本使用</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;github.com/julienschmidt/httprouter&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> JsonData <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Message <span class="token builtin">string</span> <span class="token string">`json:&quot;message&quot;`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">defaultGet</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> <span class="token boolean">_</span> httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;default get&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">defaultPost</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> <span class="token boolean">_</span> httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;default post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">preciseMatch</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> params httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;username:&quot;</span> <span class="token operator">+</span> params<span class="token punctuation">.</span><span class="token function">ByName</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">allMatch</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> params httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;username:&quot;</span> <span class="token operator">+</span> params<span class="token punctuation">.</span><span class="token function">ByName</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">notFoundPage</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;页面没有找到&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">getJson</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> <span class="token boolean">_</span> httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	jsonData <span class="token operator">:=</span> JsonData<span class="token punctuation">{</span><span class="token string">&quot;Hello World的json格式&quot;</span><span class="token punctuation">}</span>
	message<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	router <span class="token operator">:=</span> httprouter<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment">// 生成路由对象</span>
	router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/default&quot;</span><span class="token punctuation">,</span> defaultGet<span class="token punctuation">)</span> <span class="token comment">// 注册Get请求路由函数</span>
	router<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;/default&quot;</span><span class="token punctuation">,</span> defaultPost<span class="token punctuation">)</span> <span class="token comment">// 注册Post请求路由函数</span>
	router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/user/:name&quot;</span><span class="token punctuation">,</span> preciseMatch<span class="token punctuation">)</span> <span class="token comment">// 精确匹配 :name</span>
	router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/alluser/*name&quot;</span><span class="token punctuation">,</span> allMatch<span class="token punctuation">)</span>  <span class="token comment">// 匹配所有 *name</span>
    
	<span class="token comment">// 第一个参数必须是/*filepath形式，第二个参数为文件目录</span>
	router<span class="token punctuation">.</span><span class="token function">ServeFiles</span><span class="token punctuation">(</span><span class="token string">&quot;/static/*filepath&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">Dir</span><span class="token punctuation">(</span><span class="token string">&quot;./static&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 匹配所有 *filepath，用来打开静态文件</span>
    <span class="token comment">// 获得json格式的返回数据</span>
	router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/getjson&quot;</span><span class="token punctuation">,</span> getJson<span class="token punctuation">)</span>
    
	<span class="token comment">// 异常统一处理</span>
	router<span class="token punctuation">.</span>PanicHandler <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> request <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
		writer<span class="token punctuation">.</span><span class="token function">WriteHeader</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusInternalServerError<span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Fprint</span><span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token string">&quot;error:%s&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 同理handleFunc和handlerFunc</span>
	router<span class="token punctuation">.</span>NotFound <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">HandlerFunc</span><span class="token punctuation">(</span>notFoundPage<span class="token punctuation">)</span> <span class="token comment">// 404页面统一处理</span>

	log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> router<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><h3 id="_3-3-handler处理不同的二级域名"><a href="#_3-3-handler处理不同的二级域名" class="header-anchor">#</a> 3.3 Handler处理不同的二级域名</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/julienschmidt/httprouter&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> HostMap <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>http<span class="token punctuation">.</span>Handler

<span class="token keyword">func</span> <span class="token punctuation">(</span>hs HostMap<span class="token punctuation">)</span> <span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 先根据域名获取对应的Handler路由，然后分发</span>
	handler <span class="token operator">:=</span> hs<span class="token punctuation">[</span>r<span class="token punctuation">.</span>Host<span class="token punctuation">]</span>
	<span class="token keyword">if</span> handler <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		handler<span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		http<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">&quot;Forbidden&quot;</span><span class="token punctuation">,</span> <span class="token number">403</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">sub1</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> <span class="token boolean">_</span> httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;sub1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">sub2</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> <span class="token boolean">_</span> httprouter<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;sub2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	userRouter <span class="token operator">:=</span> httprouter<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	userRouter<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> sub1<span class="token punctuation">)</span>

	dataRouter <span class="token operator">:=</span> httprouter<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	dataRouter<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> sub2<span class="token punctuation">)</span>

	<span class="token comment">// 分别处理不同的二级域名</span>
	hs <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span>HostMap<span class="token punctuation">)</span>
	hs<span class="token punctuation">[</span><span class="token string">&quot;sub1.localhost:8080&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> userRouter
	hs<span class="token punctuation">[</span><span class="token string">&quot;sub2.localhost:8080&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRouter

	log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">,</span> hs<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="_3-4-完整项目包括"><a href="#_3-4-完整项目包括" class="header-anchor">#</a> 3.4 完整项目包括</h3> <p><strong>以下是我个人的理解</strong></p> <ul><li>完整的API项目
<ul><li>处理器分发请求</li> <li>控制器调用模型</li> <li>模型操作数据库</li> <li>通过HTTP报文传输给客户端</li></ul></li> <li>完整的WEB项目
<ul><li>处理器分发请求</li> <li>控制器调用模型</li> <li>模型操作数据库</li> <li>通过模板引擎将模型从数据库中返回的数据和模板拼接，生成HTML或其他格式的文档</li> <li>通过HTTP报文传输给客户端</li></ul></li></ul> <h2 id="_4-用go访问数据库"><a href="#_4-用go访问数据库" class="header-anchor">#</a> 4. 用Go访问数据库</h2> <p><strong>建议购买云数据库来降低环境配置难度，懒人如我是不可能自己配环境的</strong></p> <h3 id="_4-1-mysql的安装及使用"><a href="#_4-1-mysql的安装及使用" class="header-anchor">#</a> 4.1 MySQL的安装及使用</h3> <h4 id="_4-1-1-mysql安装"><a href="#_4-1-1-mysql安装" class="header-anchor">#</a> 4.1.1 MySQL安装</h4> <ul><li>进入Mysql官网，选择操作系统对应的安装包进行下载即可</li></ul> <h4 id="_4-1-2-mysql入门"><a href="#_4-1-2-mysql入门" class="header-anchor">#</a> 4.1.2 MySQL入门</h4> <p>MySQL是一个关系型数据库</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* data_base_name是数据库名 data_table_name是数据表名*/</span>

<span class="token comment">/* (1)创建数据库 */</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> data_base_name<span class="token punctuation">;</span>

<span class="token comment">/* (2)选择数据库 */</span>
<span class="token keyword">USE</span> databse_name<span class="token punctuation">;</span>

<span class="token comment">/* (3)查看数据库 */</span>
<span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span> <span class="token punctuation">[</span><span class="token operator">LIKE</span> <span class="token string">'data_base_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* (4)修改数据库 */</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span>data_base_name<span class="token punctuation">]</span>

<span class="token comment">/* (5)删除数据库 */</span>
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> data_base_name<span class="token punctuation">;</span>

<span class="token comment">/* (6)创建数据表 */</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> data_table_name <span class="token punctuation">(</span><span class="token punctuation">[</span>表定义选项<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>表选项<span class="token punctuation">]</span><span class="token punctuation">[</span>分区选项<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/* (7)查看数据表 */</span>
  <span class="token comment">/* 以表格形式展示表的字段信息 */</span>
<span class="token keyword">DESCRIBE</span> data_table_name<span class="token punctuation">;</span>
<span class="token keyword">DESC</span> data_table_name<span class="token punctuation">;</span>
  <span class="token comment">/* 以SQL形式展示表的字段信息 */</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> data_table_name<span class="token punctuation">;</span>

<span class="token comment">/* (8)修改数据表 */</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> data_table_name <span class="token punctuation">[</span>修改选项<span class="token punctuation">]</span>

<span class="token comment">/* (9)删除数据表 */</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> data_table_name <span class="token punctuation">[</span>data_table_name1<span class="token punctuation">,</span> data_table_name2……<span class="token punctuation">]</span>

<span class="token comment">/* (10)数据库语句 */</span>
<span class="token keyword">INSERT</span> <span class="token punctuation">[</span><span class="token keyword">INTO</span><span class="token punctuation">]</span> data_table_name <span class="token punctuation">[</span><span class="token punctuation">(</span>列名<span class="token number">1</span>， 列名<span class="token number">2</span>……<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>值<span class="token number">1</span>， 值<span class="token number">2</span>……<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 列名 <span class="token keyword">FROM</span> 表名 <span class="token punctuation">[</span>查询条件<span class="token punctuation">]</span>
<span class="token keyword">UPDATE</span> 表名 <span class="token keyword">SET</span> 列名 <span class="token operator">=</span> 新值 <span class="token keyword">WHERE</span> 更新条件
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> 表名 <span class="token keyword">WHERE</span> 删除条件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h4 id="_4-1-3-用go访问mysql"><a href="#_4-1-3-用go访问mysql" class="header-anchor">#</a> 4.1.3 用Go访问MySQL</h4> <p><strong>安装：</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>go get -u github.com/go-sql-driver/mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>基础操作的使用示例：</strong></p> <ul><li><p>导入依赖包</p> <ul><li>没有直接使用<code>github.com/go-sql-driver/mysql</code>包中的对象，所以在导入包前加上了<code>下划线 _</code></li></ul></li> <li><p>初始化数据库连接</p> <ul><li>用<code>Ping()</code>方法检查数据源名称是否合法</li> <li>只需要调用一次<code>Open()</code>函数即可</li> <li><code>SetMaxOpenConns(n int)</code>方法设置最大连接数目</li> <li><code>SetMaxldleConns(n int)</code>方法设置最大闲置连接数目</li></ul></li> <li><p>用<code>QueryRow()</code>进行单行查询</p> <ul><li>执行一次查询，返回最多一行结果</li> <li>要确保在<code>QueryRow()</code>方法之后调用<code>Scan()</code>方法来释放数据库连接</li></ul></li> <li><p>用<code>Query()</code>进行多行查询</p> <ul><li>执行一次查询，返回多行结果</li> <li>要对查询到的多行结果执行<code>defer rows.Close()</code>，延迟释放数据库连接</li></ul></li> <li><p>用<code>Exec()</code>插入、更新、删除数据</p> <ul><li><code>Exec()</code>方法用于执行一次命令，返回<code>result</code>表示已执行命令的执行结果</li></ul></li> <li><p><code>MySQL</code>预处理</p> <ul><li>预处理将SQL语句分成命令部分和数据部分，先由MySQL服务器端对命令部分进行预处理，再将数据部分发送给MySQL服务器端，由MySQL服务器端对命令部分进行占位符替换，最后执行完整的语句并将结果返回给客户端</li> <li>预处理的好处：优化MySQL服务器重复执行SQL语句的问题，提升服务器性能；节省编译成本；避免SQL注入问题</li></ul></li> <li><p>实现<code>MySQL</code>事务</p> <ul><li>事务是一个最小的、不可再分的工作单元；通常一个事务对应一个完整的业务</li> <li>事务处理用来维护数据库的完整性，保证成批的SQL语句要么全部执行，要么全部不执行</li></ul></li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;database/sql&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token boolean">_</span> <span class="token string">&quot;github.com/go-sql-driver/mysql&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 定义数据库</span>
<span class="token keyword">var</span> db <span class="token operator">*</span>sql<span class="token punctuation">.</span>DB

<span class="token comment">// 定义数据结构</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Uid      <span class="token builtin">int</span>
	UserName <span class="token builtin">string</span>
	Phone    <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义一个全局变量</span>
<span class="token keyword">var</span> u User

<span class="token comment">// 初始化数据库连接</span>
<span class="token keyword">func</span> <span class="token function">initMySQLDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Init MySQLDB link Start&quot;</span><span class="token punctuation">)</span>
	db<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username:password@tcp(url:port)/database&quot;</span><span class="token punctuation">)</span>

	<span class="token comment">// 尝试与数据库建立连接</span>
	err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Init DB link failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Init MySQLDB link Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 单行查询示例</span>
<span class="token keyword">func</span> <span class="token function">querySingleRow</span><span class="token punctuation">(</span>table <span class="token builtin">string</span><span class="token punctuation">,</span> uid <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;QuerySingleRow Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;select uid, username, phone from %s where uid = ?&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	<span class="token comment">// QueryRow()之后使用Scan()的作用是释放数据库连接</span>
	err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">QueryRow</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">,</span> uid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">.</span>Uid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;QuerySingleRow Scan failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;uid:%d  username:%s  phone:%s\n&quot;</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>Uid<span class="token punctuation">,</span> u<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;QuerySingleRow Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 多行查询示例</span>
<span class="token keyword">func</span> <span class="token function">queryMultiRow</span><span class="token punctuation">(</span>table <span class="token builtin">string</span><span class="token punctuation">,</span> uid <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;QueryMultiRow Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;select uid, username, phone from %s where uid &gt; ?&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	rows<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">,</span> uid<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;QueryMultiRow failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 关闭rows，释放数据库连接</span>
	<span class="token keyword">defer</span> rows<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">// 循环读取rows中的数据</span>
	<span class="token keyword">for</span> rows<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		err <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">.</span>Uid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;QueryMultiRow Scan failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;uid:%d  username:%s  phone:%s\n&quot;</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>Uid<span class="token punctuation">,</span> u<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;QueryMultiRow Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 插入数据示例</span>
<span class="token keyword">func</span> <span class="token function">insertRow</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> username<span class="token punctuation">,</span> phone <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;InsertRow Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;insert into %s(username,phone) values (?,?)&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">,</span> username<span class="token punctuation">,</span> phone<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;InsertRow failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 获取最新插入数据的uid</span>
	uid<span class="token punctuation">,</span> err <span class="token operator">:=</span> result<span class="token punctuation">.</span><span class="token function">LastInsertId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Get LastInsertId failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;The uid is %d.\n&quot;</span><span class="token punctuation">,</span> uid<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;InsertRow Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 更新数据示例</span>
<span class="token keyword">func</span> <span class="token function">updateRow</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> username <span class="token builtin">string</span><span class="token punctuation">,</span> uid <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;UpdateRow Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;update %s set username=? where uid = ?&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">,</span> username<span class="token punctuation">,</span> uid<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;UpdateRow failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 操作影响的行数</span>
	num<span class="token punctuation">,</span> err <span class="token operator">:=</span> result<span class="token punctuation">.</span><span class="token function">RowsAffected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Get the number of affected rows(update) failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;The number of affected rows(update) is %d.\n&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;UpdateRow Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 删除数据示例</span>
<span class="token keyword">func</span> <span class="token function">deleteRow</span><span class="token punctuation">(</span>table <span class="token builtin">string</span><span class="token punctuation">,</span> uid <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DeleteRow Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;delete from %s where uid = ?&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">,</span> uid<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;DeleteRow failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 操作影响的行数</span>
	num<span class="token punctuation">,</span> err <span class="token operator">:=</span> result<span class="token punctuation">.</span><span class="token function">RowsAffected</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Get the number of affected rows(delete) failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;The number of affected rows(delete) is %d.\n&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DeleteRow Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 预处理查询示例</span>
<span class="token keyword">func</span> <span class="token function">prepareQuery</span><span class="token punctuation">(</span>table <span class="token builtin">string</span><span class="token punctuation">,</span> uid <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareQuery Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;select uid, username, phone from %s where uid &gt; ?&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	statements<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Prepare failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> statements<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	rows<span class="token punctuation">,</span> err <span class="token operator">:=</span> statements<span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareQuery failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> rows<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">// 循环读取结果集中的数据</span>
	<span class="token keyword">for</span> rows<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		err <span class="token operator">:=</span> rows<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">.</span>Uid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareQuery Scan failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;uid:%d username:%s phone:%s\n&quot;</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>Uid<span class="token punctuation">,</span> u<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareQuery Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 预处理插入示例</span>
<span class="token keyword">func</span> <span class="token function">prepareInsert</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> username<span class="token punctuation">,</span> phone <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareInsert Start&quot;</span><span class="token punctuation">)</span>
	sqlString <span class="token operator">:=</span> <span class="token string">&quot;insert into %s(username,phone) values (?,?)&quot;</span>
	sqlStatements <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>sqlString<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
	statements<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span>sqlStatements<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Prepare failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> statements<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> statements<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> phone<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareInsert failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 获取最新插入数据的uid</span>
	uid<span class="token punctuation">,</span> err <span class="token operator">:=</span> result<span class="token punctuation">.</span><span class="token function">LastInsertId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Get LastInsertId failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;The uid is %d.\n&quot;</span><span class="token punctuation">,</span> uid<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PrepareInsert Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实现MySQL事务</span>
<span class="token keyword">func</span> <span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Exec transaction Start&quot;</span><span class="token punctuation">)</span>
	tx<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 开启事务</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> tx <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 回滚</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Begin transaction failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span><span class="token string">&quot;update go_user set username='TransactionTest1' where uid=?&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 回滚</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Exec sql1 failed, err:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span><span class="token string">&quot;update go_user set username='TransactionTest2' where uid=?&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 回滚</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Exec sql2 failed, err:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	err <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 提交事务</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 回滚</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Commit failed, err:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Exec transaction Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">initMySQLDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//querySingleRow(&quot;go_user&quot;, 1)</span>
	<span class="token comment">//queryMultiRow(&quot;go_user&quot;, 0)</span>
	<span class="token comment">//insertRow(&quot;go_user&quot;, &quot;InsertTest&quot;, &quot;17800000002&quot;)</span>
	<span class="token comment">//updateRow(&quot;go_user&quot;, &quot;UpdateTest&quot;, 1)</span>
	<span class="token comment">//deleteRow(&quot;go_user&quot;, 2)</span>
	<span class="token comment">//prepareQuery(&quot;go_user&quot;, 0)</span>
	<span class="token comment">//prepareInsert(&quot;go_user&quot;, &quot;PrepareInsertTest&quot;, &quot;17800000003&quot;)</span>
	<span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br></div></div><h3 id="_4-2-redis的安装及使用"><a href="#_4-2-redis的安装及使用" class="header-anchor">#</a> 4.2 Redis的安装及使用</h3> <h4 id="_4-2-1-redis安装"><a href="#_4-2-1-redis安装" class="header-anchor">#</a> 4.2.1 Redis安装</h4> <ul><li><a href="https://www.cnblogs.com/hunanzp/p/12304622.html" target="_blank" rel="noopener noreferrer">这个博客写的还不错<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h4 id="_4-2-2-redis入门"><a href="#_4-2-2-redis入门" class="header-anchor">#</a> 4.2.2 Redis入门</h4> <p>Redis是一个Key-Value型数据库，通常被称为数据结构服务器</p> <p>可用于缓存、事件发布、订阅、高速队列等场景</p> <p><a href="http://redisdoc.com/index.html" target="_blank" rel="noopener noreferrer">Redis 命令参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* 字符串 */</span>
字符串是Redis的基本数据结构之一，由<span class="token keyword">Key</span>和<span class="token keyword">Value</span>组成
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>查看所有的<span class="token keyword">key</span>
<span class="token keyword">keys</span> <span class="token operator">*</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>创建字符串
<span class="token keyword">set</span> <span class="token keyword">key</span> <span class="token keyword">value</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>读取字符串
get <span class="token keyword">key</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>修改<span class="token keyword">key</span>中的值，NX的作用是不覆盖旧值
<span class="token keyword">set</span> <span class="token keyword">key</span> new_value <span class="token punctuation">[</span>NX<span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>在<span class="token keyword">value</span>后追加字符串
append <span class="token keyword">key</span> <span class="token keyword">value</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>如果<span class="token keyword">key</span>存储的是数字，可以对数字进行修改
让<span class="token keyword">key</span>中数字加一： incr <span class="token keyword">key</span>
让<span class="token keyword">key</span>中数字减一： decr <span class="token keyword">key</span>
让<span class="token keyword">key</span>中数字加n： incrby <span class="token keyword">key</span> n
让<span class="token keyword">key</span>中数字减n： decrby <span class="token keyword">key</span> n
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>删除<span class="token keyword">key</span>
del <span class="token keyword">key</span>

<span class="token comment">/* 哈希(Hash) */</span>
<span class="token keyword">Hash</span>是一个string类型的field字段和<span class="token keyword">value</span>值的映射表，适合用户存储对象
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>添加数据
添加一个键值对：   hset <span class="token keyword">key</span> field <span class="token keyword">value</span>
添加多个键值对：   hmset <span class="token keyword">key</span> field1 value1 <span class="token punctuation">[</span>field2 value2<span class="token punctuation">]</span>
不修改已存在字段:  hsetnx <span class="token keyword">key</span> field <span class="token keyword">value</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>获得数据
获得一个字段的值：    hget <span class="token keyword">key</span> field
获得多个字段的值：    hmget <span class="token keyword">key</span> field1 <span class="token punctuation">[</span>field2<span class="token punctuation">]</span>
获得所有字段的名和值： hgetall <span class="token keyword">key</span>
判断是否存在字段：    HEXISTS <span class="token keyword">key</span> field
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>获得字段数量
hlen <span class="token keyword">key</span>

<span class="token comment">/* 列表 */</span>
左进右出，适合用于消息列表
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>插入数据

lpush <span class="token keyword">key</span> <span class="token keyword">value</span>
rpush <span class="token keyword">key</span> <span class="token keyword">value</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>获得列表长度
llen <span class="token keyword">key</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>查看数据
lrange <span class="token keyword">key</span> 开始索引 结束索引
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>弹出数据（弹出后删除数据）
lpop <span class="token keyword">key</span>
rpop <span class="token keyword">key</span>

<span class="token comment">/* 集合(Set) */</span>
数据是无序的，不能重复
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>添加数据
sadd <span class="token keyword">key</span> value1 value2 value3
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>获得集合中元素
获得成员数量： scard <span class="token keyword">key</span>
获得所有成员： smembers <span class="token keyword">key</span>

<span class="token comment">/* 有序集合 */</span>
相比于集合，有序集合的元素会关联一个<span class="token keyword">double</span>类型的分数，其中元素不能重复，但分数可以重复，可用于高并发场景的数据更新且需要实时获取排名
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>添加数据
zadd <span class="token keyword">key</span> score1 member1 <span class="token punctuation">[</span>score2 member2<span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>修改数据
zadd <span class="token keyword">key</span> NX score member
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>获取数据
zrangebyscore <span class="token keyword">key</span> min max <span class="token punctuation">[</span>WITHSCORES<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">LIMIT</span> <span class="token keyword">offset</span> count<span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>获得排名
zrank <span class="token keyword">key</span> member
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>获取一个值的评分
zscore <span class="token keyword">key</span> member
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>查看某个评分范围内的值有多少
zcount <span class="token keyword">key</span> min max
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h4 id="_4-2-3-用go访问redis"><a href="#_4-2-3-用go访问redis" class="header-anchor">#</a> 4.2.3 用Go访问Redis</h4> <p><strong>安装</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>go get github.com/gomodule/redigo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>基础操作的使用示例：</strong></p> <ul><li>设置和获取字符串
<ul><li>最常用的方法是<code>Do()</code>方法，可以直接支持Redis的<code>Set</code>、<code>Get</code>、<code>MSet</code>、<code>MGet</code>、<code>HSet</code>、<code>HGet</code>、<code>expire</code>等常用命令</li> <li><code>redis.String()</code>方法可以用来获取字符串</li> <li><code>redis.String()</code>方法可以用来批量获取字符串</li></ul></li> <li>设置过期时间
<ul><li>通过<code>Do()</code>方法设置某个值的过期时间，可用于验证码</li></ul></li> <li><code>Redis</code>连接池
<ul><li>在一次数据交互中建立连接占用了大部分时间</li> <li>连接池可以实现与客户端建立多个与服务器的连接而不释放。当需要连接的时候通过一定算法获取已建立的连接，使用过后再还给连接池，免去了连接服务器所占用的时间</li></ul></li> <li><code>Redis</code>实现管道操作
<ul><li>请求/响应服务可以实现持续处理新请求。客户端可以发送多个命令到服务器而无需等待响应，最后一次性读取多个响应</li> <li><code>Send()</code>方法用于向连接的输出缓冲中写入命令</li> <li><code>Flush()</code>方法用于将连接的输出缓冲清空并写入服务器端</li> <li><code>Receive()</code>方法用于按照FIFO顺序依次读取服务器端的响应</li> <li>Redis管道可以用于高并发场景，因为客户端无需等待响应，只需要发送多条命令到服务器端，按照顺序读取响应即可</li></ul></li> <li><code>Redis</code>实现事务
<ul><li><code>MULTI</code>：开启事务</li> <li><code>EXEC</code>：执行事务</li> <li><code>DISCARD</code>：取消事务</li> <li><code>WATCH</code>：监视事务中的键变化，一旦有改变则取消事务</li></ul></li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;github.com/gomodule/redigo/redis&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> pool <span class="token operator">*</span>redis<span class="token punctuation">.</span>Pool

<span class="token comment">// 初始化Redis数据库连接池</span>
<span class="token keyword">func</span> <span class="token function">initRedisDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认使用DB0，如果需要使用其他数据库需要设置redis.DialDatabase()</span>
	<span class="token comment">// setdb := redis.DialDatabase(12)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Init RedisDB link Start&quot;</span><span class="token punctuation">)</span>
	pool <span class="token operator">=</span> <span class="token operator">&amp;</span>redis<span class="token punctuation">.</span>Pool<span class="token punctuation">{</span>
		MaxIdle<span class="token punctuation">:</span>     <span class="token number">16</span><span class="token punctuation">,</span>
		MaxActive<span class="token punctuation">:</span>   <span class="token number">1024</span><span class="token punctuation">,</span>
		IdleTimeout<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
		Dial<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>redis<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> redis<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r-uf6mtfiwaxhf4difm6pd.redis.rds.aliyuncs.com:6379&quot;</span><span class="token punctuation">,</span>
				redis<span class="token punctuation">.</span><span class="token function">DialPassword</span><span class="token punctuation">(</span><span class="token string">&quot;200199Yhn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Init RedisDB link Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置字符串</span>
<span class="token keyword">func</span> <span class="token function">setData</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Set Start&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;Set&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Set failed, error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Set Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取字符串</span>
<span class="token keyword">func</span> <span class="token function">getData</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Get Start&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;Get&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Get failed, error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Get result&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Get Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 批量设置字符串</span>
<span class="token keyword">func</span> <span class="token function">msetData</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MSet Start&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;MSet&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MSetTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;phone&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18888888888&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;MSet failed, error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MSet Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 批量获取字符串</span>
<span class="token keyword">func</span> <span class="token function">mgetData</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MGet Start&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">Strings</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;MGet&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;MGet failed, error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;MGet result&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MGet Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置哈希类型数据</span>
<span class="token keyword">func</span> <span class="token function">setHashData</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;HSet Start&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;HSet&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SetHashTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Test1&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;HSet failed, error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;HSet Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取哈希类型数据</span>
<span class="token keyword">func</span> <span class="token function">getHashData</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;HGet Start&quot;</span><span class="token punctuation">)</span>
	<span class="token comment">// 注意这里要用redis.String()，返回类型为stirng，Strings的返回类型为[]string</span>
	r<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;HGet&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SetHashTest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;HGet failed, error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;HGet result:&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;HGet Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置过期时间</span>
<span class="token keyword">func</span> <span class="token function">setExpire</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Expire Start&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;expire&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Expire error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Expire Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将数据压入队列，采用左侧压入</span>
<span class="token keyword">func</span> <span class="token function">pushQueue</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PushQueue Start&quot;</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;lpush&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Queue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;LpushTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Test1&quot;</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;PushQueue error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PushQueue Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将数据弹出队列，采用左侧弹出</span>
<span class="token keyword">func</span> <span class="token function">popQueue</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PopQueue Start&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;lpop&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Queue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;PopQueue error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;PopQueue result:&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PopQueue Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取队列长度</span>
<span class="token keyword">func</span> <span class="token function">getQueueLen</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;GetQueueLen Start&quot;</span><span class="token punctuation">)</span>
	r<span class="token punctuation">,</span> err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">Int</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;llen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Queue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;GetQueueLen error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;GetQueueLen result:&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;GetQueueLen Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 管道操作，可用于并发</span>
<span class="token keyword">func</span> <span class="token function">pipOperat</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;PipOperat Start&quot;</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">&quot;SET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PipTest1&quot;</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">&quot;SET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PipTest2&quot;</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	status<span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;v:%v,err:%v\n&quot;</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	status<span class="token punctuation">,</span> err <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">Receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;v:%v,err:%v\n&quot;</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	status<span class="token punctuation">,</span> err <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">Receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 一直等待</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;v:%v,err:%v\n&quot;</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Pip Operation Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 事务操作</span>
<span class="token keyword">func</span> <span class="token function">transactionRedis</span><span class="token punctuation">(</span>conn redis<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionRedis Start&quot;</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">&quot;MULTI&quot;</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">&quot;INCR&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TranscationTest1&quot;</span><span class="token punctuation">)</span>
	conn<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">&quot;INCR&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;TranscationTest2&quot;</span><span class="token punctuation">)</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">&quot;EXEC&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionRedis error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionRedis Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">initRedisDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	conn <span class="token operator">:=</span> pool<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">//setData(conn, &quot;username&quot;, &quot;SetTest&quot;)</span>
	<span class="token comment">//getData(conn, &quot;username&quot;)</span>
	<span class="token comment">//msetData(conn)</span>
	<span class="token comment">//mgetData(conn)</span>
	<span class="token comment">//setHashData(conn)</span>
	<span class="token comment">//getHashData(conn)</span>
	<span class="token comment">//setExpire(conn, &quot;Hash&quot;)</span>
	<span class="token comment">//pushQueue(conn)</span>
	<span class="token comment">//popQueue(conn)</span>
	<span class="token comment">//getQueueLen(conn)</span>
	<span class="token comment">//pipOperat(conn)</span>
	<span class="token function">transactionRedis</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br></div></div><h3 id="_4-3-mongodb的安装及使用"><a href="#_4-3-mongodb的安装及使用" class="header-anchor">#</a> 4.3 MongoDB的安装及使用</h3> <p><strong>注：因为个人学习没有应用到MongoDB，所以打算之后再学习MongoDB，补充相应的笔记</strong></p> <h4 id="_4-3-1-mongodb安装"><a href="#_4-3-1-mongodb安装" class="header-anchor">#</a> 4.3.1 MongoDB安装</h4> <ul><li>进入MongoDB官网下载安装即可</li></ul> <h4 id="_4-3-2-mongodb入门"><a href="#_4-3-2-mongodb入门" class="header-anchor">#</a> 4.3.2 MongoDB入门</h4> <p>MongoDB是一种非关系型数据库，基于分布式文件存储，使用C++语言编写</p> <p>作用是为Web应用提供可扩展的高性能数据存储解决方案</p> <p><a href="https://www.mongodb.org.cn/tutorial/1.html" target="_blank" rel="noopener noreferrer">MongoDB中文网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* 数据库操作 */</span>

<span class="token comment">/* 集合操作 */</span>

<span class="token comment">/* 文档操作 */</span>

<span class="token comment">/* 修改文档 */</span>

<span class="token comment">/* 删除文档 */</span>

<span class="token comment">/* 文档去重 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_4-3-3-用go访问mongodb"><a href="#_4-3-3-用go访问mongodb" class="header-anchor">#</a> 4.3.3 用Go访问MongoDB</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>暂无内容
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-4-go的常见orm库"><a href="#_4-4-go的常见orm库" class="header-anchor">#</a> 4.4 Go的常见ORM库</h3> <h4 id="_4-4-1-什么是orm"><a href="#_4-4-1-什么是orm" class="header-anchor">#</a> 4.4.1 什么是ORM</h4> <p>ORM全称为Object-Relation Mapping，对象关系映射，其作用是在关系型数据库和对象之间做一个映射。这样在操作数据库时就不需要和SQL语句打交道。</p> <ul><li>O（对象模型）：实体对象，即在程序中根据数据库表结构建立的一个个实体(Entity)</li> <li>R（关系型数据库的数据结构）：建立的数据库表</li> <li>M（映射）：从R到O的映射，常用XML文件来表示映射关系</li></ul> <h4 id="_4-4-2-安装及使用"><a href="#_4-4-2-安装及使用" class="header-anchor">#</a> 4.4.2 安装及使用</h4> <p><strong>安装</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>go get -u github.com/jinzhu/gorm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>基础操作的使用示例：</strong></p> <ul><li>数据库的连接：直接使用<code>gorm.Open()</code>函数传入数据库信息</li> <li>自动建表：<code>db.AutoMigrate()</code>函数可以根据结构体信息自动建表</li> <li>插入数据：
<ul><li><code>Save()</code></li> <li><code>Create()</code></li> <li>两个函数均可以插入数据，注意指针的使用</li></ul></li> <li>删除数据：先用<code>db.Where()</code>构造查询条件，再用<code>db.Delete()</code>删除</li> <li>查询数据：
<ul><li>先用<code>db.Where()</code>构造查询条件</li> <li>用<code>db.Count()</code>计算数量</li> <li>用<code>db.Find()</code>查询多条数据</li> <li>直接用<code>db.First()</code>查询单条数据</li> <li>注意指针的使用</li></ul></li> <li>更新数据：使用<code>Update()</code>方法更新数据</li> <li>错误处理：直接在上述方法后使用<code>db.Error()</code>方法即可获取错误信息</li> <li>事务处理：
<ul><li><code>db.Begin()</code> 开启事务</li> <li><code>tx.Commit()</code> 提交事务</li> <li><code>tx.Rollback()</code> 回滚</li></ul></li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;github.com/jinzhu/gorm&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 定义数据库</span>
<span class="token keyword">var</span> <span class="token punctuation">(</span>
	gormDB        <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB
	sqlConnection <span class="token operator">=</span> <span class="token string">&quot;username:password@tcp(url:port)/database&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 定义结构体</span>
<span class="token keyword">type</span> GormUser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ID       <span class="token builtin">uint</span>   <span class="token string">`json:&quot;ID&quot;`</span>
	Phone    <span class="token builtin">string</span> <span class="token string">`json:&quot;Phone&quot;`</span>
	Username <span class="token builtin">string</span> <span class="token string">`json:&quot;Username&quot;`</span>
	Password <span class="token builtin">string</span> <span class="token string">`json:&quot;Password&quot;`</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化数据库连接</span>
<span class="token keyword">func</span> <span class="token function">initGormDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Init GormDB link Start&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> err <span class="token builtin">error</span>
	gormDB<span class="token punctuation">,</span> err <span class="token operator">=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> sqlConnection<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Init GormDB link failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	gormDB<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetMaxIdleConns</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment">// 最大连接数</span>
	gormDB<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetMaxOpenConns</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">// 最大打开连接数</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Init GormDB link Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 根据结构体创建表</span>
<span class="token keyword">func</span> <span class="token function">createTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CreateTable Start&quot;</span><span class="token punctuation">)</span>
	gormDB<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CreateTable Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 插入数据</span>
<span class="token keyword">func</span> <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SavaData Start&quot;</span><span class="token punctuation">)</span>
	GormUser1 <span class="token operator">:=</span> GormUser<span class="token punctuation">{</span>
		Phone<span class="token punctuation">:</span>    <span class="token string">&quot;17800000000&quot;</span><span class="token punctuation">,</span>
		Username<span class="token punctuation">:</span> <span class="token string">&quot;GormInsertTest1&quot;</span><span class="token punctuation">,</span>
		Password<span class="token punctuation">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
    err <span class="token operator">:=</span> gormDB<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser1<span class="token punctuation">)</span><span class="token punctuation">.</span>Error <span class="token comment">// 使用Save()函数插入</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;SavaData failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SavaData Success&quot;</span><span class="token punctuation">)</span>

	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CreateData Start&quot;</span><span class="token punctuation">)</span>
	GormUser2 <span class="token operator">:=</span> GormUser<span class="token punctuation">{</span>
		Phone<span class="token punctuation">:</span>    <span class="token string">&quot;17800000001&quot;</span><span class="token punctuation">,</span>
		Username<span class="token punctuation">:</span> <span class="token string">&quot;GormInsertTest2&quot;</span><span class="token punctuation">,</span>
		Password<span class="token punctuation">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	err <span class="token operator">=</span> gormDB<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser2<span class="token punctuation">)</span><span class="token punctuation">.</span>Error <span class="token comment">// 使用Create()函数插入</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;SavaData failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CreateData Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 查询数据</span>
<span class="token keyword">func</span> <span class="token function">checkData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CheckData Start&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> GormUser1 <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>GormUser<span class="token punctuation">)</span>
	err <span class="token operator">:=</span> gormDB<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;Phone = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;17800000000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser1<span class="token punctuation">)</span><span class="token punctuation">.</span>Error
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Find failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Find查询结果为:&quot;</span><span class="token punctuation">,</span> GormUser1<span class="token punctuation">)</span>

	<span class="token keyword">var</span> GormUser2 <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>GormUser<span class="token punctuation">)</span>
	err <span class="token operator">=</span> gormDB<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser2<span class="token punctuation">,</span> <span class="token string">&quot;Phone = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;17800000001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Error
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;First failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;First查询结果为:&quot;</span><span class="token punctuation">,</span> GormUser2<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CheckData Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 更新数据</span>
<span class="token keyword">func</span> <span class="token function">updateData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;UpdateData Start&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> GormUser1 <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>GormUser<span class="token punctuation">)</span>
	err <span class="token operator">:=</span> gormDB<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;Phone = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;17800000001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token string">&quot;Phone&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;17800000002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Error
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;UpdateData failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;UpdateData Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 删除数据</span>
<span class="token keyword">func</span> <span class="token function">deleteData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DeleteData Start&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> GormUser1 <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>GormUser<span class="token punctuation">)</span>
	err <span class="token operator">:=</span> gormDB<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;Phone = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;17800000000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser1<span class="token punctuation">)</span><span class="token punctuation">.</span>Error
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;DeleteData failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DeleteData Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Gorm实现事务</span>
<span class="token keyword">func</span> <span class="token function">transactionGorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionGorm Start&quot;</span><span class="token punctuation">)</span>
	tx <span class="token operator">:=</span> gormDB<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	GormUser1 <span class="token operator">:=</span> GormUser<span class="token punctuation">{</span>
		Phone<span class="token punctuation">:</span>    <span class="token string">&quot;17800000004&quot;</span><span class="token punctuation">,</span>
		Username<span class="token punctuation">:</span> <span class="token string">&quot;TransactionTest&quot;</span><span class="token punctuation">,</span>
		Password<span class="token punctuation">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	err <span class="token operator">:=</span> tx<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser1<span class="token punctuation">)</span><span class="token punctuation">.</span>Error
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token comment">//事务回滚</span>
		tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionGorm failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> GormUser2 <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span>GormUser<span class="token punctuation">)</span>
	gormDB<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GormUser2<span class="token punctuation">,</span> <span class="token string">&quot;phone = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;17800000004&quot;</span><span class="token punctuation">)</span>
	<span class="token comment">//事务提交</span>
	tx<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;First查询结果为:&quot;</span><span class="token punctuation">,</span> GormUser2<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionGorm Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">initGormDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//createTable()</span>
	<span class="token comment">//insertData()</span>
	<span class="token comment">//checkData()</span>
	<span class="token comment">//updateData()</span>
	<span class="token comment">//deleteData()</span>
	<span class="token function">transactionGorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br></div></div><h4 id="_4-4-3-go语言的orm框架-beego-orm"><a href="#_4-4-3-go语言的orm框架-beego-orm" class="header-anchor">#</a> 4.4.3 Go语言的ORM框架——Beego ORM</h4> <p><strong>安装</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>go get -u github.com/astaxie/beego/orm
<span class="token comment"># 在使用Beego ORM前必须先导入MySQL数据库驱动程序</span>
go get -u github.com/go-sql-driver/mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>基础操作的使用示例：</strong></p> <ul><li>数据库的连接：用<code>orm.RegisterDataBase()</code>方法，必须注册一个名为<code>default</code>的数据库作为默认使用，再传入数据库信息</li> <li>注册模型：
<ul><li>如果使用<code>orm.QuerySeter</code>接口进行高级查询，则必须注册模型，且要在数据库连接之前注册</li> <li>如果只是用<code>Raw</code>查询和映射到<code>Struct</code>，无需注册模型</li> <li>注册模型的作用是将<code>ORM</code>语句转化为<code>SQL</code>语句并写入数据库</li></ul></li> <li>自动建表：<code>orm.RunSyncdb(&quot;default&quot;, false, true)</code>，根据默认数据表的结构体建表</li> <li>插入数据：调用<code>Insert()</code>方法</li> <li>查询数据：调用<code>Read()</code>方法</li> <li>更新数据：调用<code>Update()</code>方法</li> <li>删除数据：指定主键<code>Id</code>，调用<code>Delete()</code>方法</li> <li>原生<code>SQL</code>方法：用<code>SQL</code>语句直接操作<code>Raw()</code>方法，返回一个<code>RawSeter</code>对象，对返回对象使用<code>Exec()</code>方法即可使用</li> <li>事务处理：
<ul><li><code>Begin()</code> 开启事务</li> <li><code>Rollback()</code> 回滚</li> <li><code>Commit()</code> 提交事务</li></ul></li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;github.com/astaxie/beego/orm&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> o orm<span class="token punctuation">.</span>Ormer

<span class="token comment">// 定义结构体</span>
<span class="token keyword">type</span> BeegoUser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Id       <span class="token builtin">int</span>
	UserName <span class="token builtin">string</span>
	Phone    <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// 注册模型</span>
<span class="token keyword">func</span> <span class="token function">registerOrmModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;RegisterOrmModel Start&quot;</span><span class="token punctuation">)</span>
	orm<span class="token punctuation">.</span><span class="token function">RegisterModel</span><span class="token punctuation">(</span><span class="token function">new</span><span class="token punctuation">(</span>BeegoUser<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;RegisterOrmModel Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化数据库连接</span>
<span class="token keyword">func</span> <span class="token function">initBeegoOrmDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;InitBeegoOrmDB Start&quot;</span><span class="token punctuation">)</span>
	orm<span class="token punctuation">.</span><span class="token function">RegisterDriver</span><span class="token punctuation">(</span><span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> orm<span class="token punctuation">.</span>DRMySQL<span class="token punctuation">)</span> <span class="token comment">// 数据库类型设计</span>
	orm<span class="token punctuation">.</span><span class="token function">RegisterDataBase</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username:password@tcp(url:port)/database&quot;</span><span class="token punctuation">)</span>
	<span class="token function">registerOrmModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 需要写在建立连接之前</span>
	o <span class="token operator">=</span> orm<span class="token punctuation">.</span><span class="token function">NewOrm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;InitBeegoOrmDB Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 根据结构体建表</span>
<span class="token keyword">func</span> <span class="token function">createTableBeegoOrm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CreateTableBeegoOrm Start&quot;</span><span class="token punctuation">)</span>
	<span class="token comment">//自动建表</span>
	orm<span class="token punctuation">.</span><span class="token function">RunSyncdb</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CreateTableBeegoOrm Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 插入数据</span>
<span class="token keyword">func</span> <span class="token function">BeegoOrmInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmInsert Start&quot;</span><span class="token punctuation">)</span>
	user <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>BeegoUser<span class="token punctuation">)</span>
	user<span class="token punctuation">.</span>UserName <span class="token operator">=</span> <span class="token string">&quot;BeegoOrmInsert2&quot;</span>
	user<span class="token punctuation">.</span>Phone <span class="token operator">=</span> <span class="token string">&quot;17800000001&quot;</span>

	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> o<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmInsert failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmInsert Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 查询数据</span>
<span class="token keyword">func</span> <span class="token function">BeegoOrmCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmCheck Start&quot;</span><span class="token punctuation">)</span>
	user <span class="token operator">:=</span> BeegoUser<span class="token punctuation">{</span><span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">1</span>

	err <span class="token operator">:=</span> o<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">==</span> orm<span class="token punctuation">.</span>ErrNoRows <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;查询无果&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> err <span class="token operator">==</span> orm<span class="token punctuation">.</span>ErrMissPK <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;找不到主键&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> user<span class="token punctuation">.</span>UserName<span class="token punctuation">,</span> user<span class="token punctuation">.</span>Phone<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmCheck Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 更新数据</span>
<span class="token keyword">func</span> <span class="token function">BeegoOrmUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmUpdate Start&quot;</span><span class="token punctuation">)</span>
	user <span class="token operator">:=</span> BeegoUser<span class="token punctuation">{</span><span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">1</span>
	user<span class="token punctuation">.</span>UserName <span class="token operator">=</span> <span class="token string">&quot;BeegoOrmUpdate&quot;</span>

	num<span class="token punctuation">,</span> err <span class="token operator">:=</span> o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmUpdate failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;更新影响了&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token string">&quot;行&quot;</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmUpdate Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 删除数据</span>
<span class="token keyword">func</span> <span class="token function">BeegoOrmDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmDelete Start&quot;</span><span class="token punctuation">)</span>
	user <span class="token operator">:=</span> BeegoUser<span class="token punctuation">{</span><span class="token punctuation">}</span>
	user<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">1</span>

	num<span class="token punctuation">,</span> err <span class="token operator">:=</span> o<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmDelete failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;删除影响了&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token string">&quot;行&quot;</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeegoOrmDelete Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 原生SQL语句</span>
<span class="token keyword">func</span> <span class="token function">nativeSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;NativeSQL Start&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> r orm<span class="token punctuation">.</span>RawSeter
	r <span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">Raw</span><span class="token punctuation">(</span><span class="token string">&quot;UPDATE beego_user SET user_name = ? WHERE user_name = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;NativeUpdate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;BeegoOrmUpdate&quot;</span><span class="token punctuation">)</span>
	result<span class="token punctuation">,</span> err <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;NativeSQL failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">RowsAffected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;NativeSQL Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// BeegoOrm实现事务</span>
<span class="token keyword">func</span> <span class="token function">transactionBeegoOrm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionBeegoOrm Start&quot;</span><span class="token punctuation">)</span>
	o<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	user1 <span class="token operator">:=</span> BeegoUser<span class="token punctuation">{</span><span class="token punctuation">}</span>
	user1<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">6</span>
	user1<span class="token punctuation">.</span>UserName <span class="token operator">=</span> <span class="token string">&quot;TransactionBeegoOrm1&quot;</span>

	user2 <span class="token operator">:=</span> BeegoUser<span class="token punctuation">{</span><span class="token punctuation">}</span>
	user2<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">12</span>
	user2<span class="token punctuation">.</span>UserName <span class="token operator">=</span> <span class="token string">&quot;TransactionBeegoOrm2&quot;</span>

	<span class="token boolean">_</span><span class="token punctuation">,</span> err1 <span class="token operator">:=</span> o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user1<span class="token punctuation">)</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err2 <span class="token operator">:=</span> o<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user2<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err1 <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">||</span> err2 <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionBeegoOrm failed, error:%v\n&quot;</span><span class="token punctuation">,</span> err1<span class="token punctuation">,</span> err2<span class="token punctuation">)</span>
		o<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	o<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TransactionBeegoOrm Success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">initBeegoOrmDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//createTableBeegoOrm()</span>
	<span class="token comment">//BeegoOrmInsert()</span>
	<span class="token comment">//BeegoOrmCheck()</span>
	<span class="token comment">//BeegoOrmUpdate()</span>
	<span class="token comment">//BeegoOrmDelete()</span>
	<span class="token comment">//nativeSQL()</span>
	<span class="token comment">//transactionBeegoOrm()</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br></div></div><h2 id="_5-小结"><a href="#_5-小结" class="header-anchor">#</a> 5. 小结</h2> <p><strong>Go Web基础知识到此结束！完结撒花</strong></p> <p><strong>开始学习高级应用！</strong></p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/14/2022, 10:00:38 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/648d11/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Go basics</div></a> <a href="/pages/ed6347/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Go Web Advanced</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/648d11/" class="prev">Go basics</a></span> <span class="next"><a href="/pages/ed6347/">Go Web Advanced</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/assets/js/app.7731fe9a.js" defer></script><script src="/assets/js/2.8135f503.js" defer></script><script src="/assets/js/58.ece82136.js" defer></script><script src="/assets/js/3.c554437f.js" defer></script>
  </body>
</html>
