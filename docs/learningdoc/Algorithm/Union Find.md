---
title: Union Find
date: 2022-05-14 21:30:50
permalink: /pages/a37b4b/
categories: 
  - learningdoc
  - Algorithm
tags: 
  - 
---
# å¹¶æŸ¥é›†

## é¢˜è§£æ¥æº

**æ ‡äº†ğŸ¤¦â€â™‚ï¸ğŸ¤¦â€â™‚ï¸çš„æ˜¯å®Œå…¨æŒ‰ç…§å¤§ä½¬ä»¬çš„é¢˜è§£å†™çš„**

**æ ‡äº†ğŸŒŸçš„æ˜¯ç†è§£äº†å¤§ç¥ä»¬çš„é¢˜è§£åï¼Œè‡ªå·±åˆå†™çš„**

**æ²¡æ ‡çš„æ˜¯è‡ªå·±ç£•ç£•ç»Šç»Šå†™å‡ºæ¥çš„ä½æ°´å¹³ä»£ç **



## è‡ªå·±å†™ä¸ªæ¨¡æ¿

```cpp
// parentæ˜¯æ¯ä¸ªç‚¹çš„ç¥–å®—ç»“ç‚¹
// sizeåªå¯¹ç¥–å®—ç»“ç‚¹æœ‰æ„ä¹‰ï¼Œä¿å­˜è¯¥åŒºé—´å†…ç‚¹çš„æ•°é‡
vector<int> parent, size;
void initUnion(int len){
    parent.resize(len);
    size.resize(len);
    for(int i = 0; i < len; i ++){
        parent[i] = i;
        size[i] = 1;
    }
}

int find(int x){
    if(x != parent[x]){ // è·¯å¾„å‹ç¼©ï¼Œè§†æƒ…å†µæ·»åŠ 
        parent[x] = find(parent[x]);
    }
    return parent[x];
}

int getSize(int x){
    return size[find(x)];
}

void merge(int a, int b){ // å¯ä»¥æ‰‹åŠ¨æŒ‡å®šç‰¹å®šåŒºé—´çš„ç¥–å®—ç»“ç‚¹ï¼Œè§130é¢˜
    int pa = find(a), pb = find(b);
    if(pa == pb){
        return;
    }
    parent[pb] = pa; 
    size[pa] += size[pb];
}
```

````
æ ¸å¿ƒæ€æƒ³
å¹¶æŸ¥é›†çš„å®ç°æ–¹å¼ä¸­å¯ä»¥æ”¹å˜çš„å‡ ä¸ªåœ°æ–¹
è·¯å¾„å‹ç¼©ã€ç»Ÿè®¡æ¯ä¸ªé›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ã€è®°å½•æœ€å¤§é›†åˆå…ƒç´ ä¸ªæ•°

è¦çµæ´»ä½¿ç”¨mapã€setç­‰æ•°æ®ç»“æ„æ¥é™ä½æ—¶é—´å¤æ‚åº¦
å…³äºåœ°å›¾ï¼Œç –å—ï¼Œç½‘æ ¼çš„é¢˜ç›®ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªç‰¹æ®ŠèŠ‚ç‚¹ï¼Œå°†å››å‘¨è¾¹ç¼˜çš„ç –å—æˆ–è€…ç½‘æ ¼éƒ½ union() åˆ°è¿™ä¸ªç‰¹æ®ŠèŠ‚ç‚¹ä¸Šã€‚


PSï¼š
å¹¶æŸ¥é›†æ˜¯ç›®å‰ç»ƒè¿‡æœ€éš¾çš„é¢˜ç›®äº†
å¹¶æŸ¥é›†çš„éš¾åº¦ä¸åœ¨æ„é€ å¹¶æŸ¥é›†ï¼›è€Œåœ¨æ€è·¯ï¼Œæˆ‘ä»¬è¦æƒ³å‡ºæ¥ï¼Œç”¨ä»€ä¹ˆæ„é€ å¹¶æŸ¥é›†ï¼Œæ„é€ ä¹‹åè¦å¦‚ä½•ä½¿ç”¨
å¯èƒ½è¿˜æ˜¯ç»ƒå¾—å°‘ï¼Œåšè¿™ç§é¢˜æ²¡ä»€ä¹ˆæ€è·¯ï¼Œä½†çœ‹ä¸€çœ¼é¢˜è§£æ€è·¯å°±ç«‹é©¬ä¼šåšäº†
åªèƒ½è¯´æ„é€ éš¾åº¦å’Œé€»è¾‘éš¾åº¦éƒ½ä½ï¼Œä½†è§£é¢˜æ€è·¯æ˜¯éœ€è¦å¤§é‡ç»ƒä¹ ï¼ˆæˆ–è€…æ˜¯å¤©èµ‹å¼‚ç¦€ï¼‰æ‰èƒ½æœ‰
10é“å¹¶æŸ¥é›†çš„ç»ƒä¹ é¢˜ï¼Œåªæœ‰ä¸¤é“æ˜¯çº¯è‡ªå·±å†™çš„
æ…¢æ…¢è®­ç»ƒè§£é¢˜æ€ç»´ï¼
````



## é¢˜ç›®

### 128. æœ€é•¿è¿ç»­åºåˆ— <span id="128"></span>

**éš¾åº¦ï¼š**<font color=#ffa119>ä¸­ç­‰</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªæœªæ’åºçš„æ•´æ•°æ•°ç»„ `nums` ï¼Œæ‰¾å‡ºæ•°å­—è¿ç»­çš„æœ€é•¿åºåˆ—ï¼ˆä¸è¦æ±‚åºåˆ—å…ƒç´ åœ¨åŸæ•°ç»„ä¸­è¿ç»­ï¼‰çš„é•¿åº¦

è¯·ä½ è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º `O(n)` çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šnums = [100,4,200,1,3,2]
è¾“å‡ºï¼š4
è§£é‡Šï¼šæœ€é•¿æ•°å­—è¿ç»­åºåˆ—æ˜¯ [1, 2, 3, 4]ã€‚å®ƒçš„é•¿åº¦ä¸º 4ã€‚
```

```
è¾“å…¥ï¼šnums = [0,3,7,2,5,8,4,6,0,1]
è¾“å‡ºï¼š9
```

**æç¤ºï¼š**

- `0 <= nums.length <= 105`
- `-109 <= nums[i] <= 109`

**è§£é¢˜æ€è·¯ï¼š**

- å› ä¸ºè¦æ‰¾å‡ºæœ€é•¿çš„å­åŒºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬é™¤äº†è¦ç»´æŠ¤ä¸€ä¸ª`parent`æ•°ç»„ï¼Œè¿˜è¦ç»´æŠ¤ä¸€ä¸ª`size`æ•°ç»„ç”¨æ¥å­˜æ”¾æ¯ä¸ªå­åŒºé—´çš„å¤§å°
- é¦–å…ˆåˆå§‹åŒ–å¹¶æŸ¥é›†ï¼Œæ¯ä¸ªå…ƒç´ çš„ç¥–å®—ç»“ç‚¹éƒ½æ˜¯è‡ªèº«
- éå†`nums`ï¼Œç”¨`map`å­˜å‚¨æ¯ä¸€ä¸ªå…ƒç´ `num`
  - å…ˆåœ¨`map`ä¸­å¯»æ‰¾æœ‰æ²¡æœ‰`num+1`å’Œ`num-1`ï¼Œå› ä¸º`num`å¯ä»¥å’Œè¿™ä¸¤ä¸ªæ•°æ®åˆå¹¶æˆä¸€ä¸ªå­åŒºé—´
  - å¦‚æœæœ‰ï¼Œå°±åˆå¹¶ä¸¤ä¸ªå…ƒç´ æ‰€åœ¨çš„åŒºé—´
  - å¦‚æœæ²¡æœ‰ï¼Œå°±ç»§ç»­éå†ç›´è‡³ç»“æŸ
- æœ€åä»`size`æ•°ç»„ä¸­æ‰¾åˆ°æœ€å¤§çš„å­åŒºé—´é•¿åº¦è¿”å›å³å¯

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent, size;

    int find(int x){ // æ‰¾åˆ°ç¥–å®—ç»“ç‚¹
        if (parent[x] != x){ // åšè·¯å¾„å‹ç¼©
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){ // åˆå¹¶ä¸¤ä¸ªåŒºé—´ï¼Œå°†bå¹¶åˆ°aä¸Š
        parent[find(b)] = find(a);
        size[find(a)] = size[find(a)] + size[find(b)];
    }

    void initUnion(int length){ // åˆå§‹åŒ–å¹¶æŸ¥é›†
        parent.resize(length);
        size.resize(length);
        for(int i = 0; i < length; i ++){
            parent[i] = i;
            size[i] = 1;
        }
    }

    int getMaxSize(int length){ // è·å¾—æœ€é•¿å­åŒºé—´
        int maxSize = 0;
        for(int i = 0; i < length; i ++){
            maxSize = max(maxSize, size[i]);
        }
        return maxSize;
    }

    int longestConsecutive(vector<int>& nums) {
        int length = nums.size();
        if(length == 0){
            return 0;
        }
        initUnion(length);
        map<int, int> mapnums;

        for(int i = 0; i < length; i ++){ // åˆå¹¶
            if(mapnums.find(nums[i]) != mapnums.end()){
                continue;
            }
            if(mapnums.find(nums[i] + 1) != mapnums.end()){
                merge(i, mapnums[nums[i] + 1]);
            }
            if(mapnums.find(nums[i] - 1) != mapnums.end()){
                merge(i, mapnums[nums[i] - 1]);
            }
            mapnums.insert({nums[i], i});
        }
        
        return getMaxSize(length);
    }
};
```



### 130. è¢«å›´ç»•çš„åŒºåŸŸ <span id="130"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ffa119>ä¸­ç­‰</font>

**é¢˜ç›®ï¼š**

ç»™ä½ ä¸€ä¸ª `m x n` çš„çŸ©é˜µ `board` ï¼Œç”±è‹¥å¹²å­—ç¬¦ `'X'` å’Œ `'O'` ï¼Œæ‰¾åˆ°æ‰€æœ‰è¢« `'X'` å›´ç»•çš„åŒºåŸŸï¼Œå¹¶å°†è¿™äº›åŒºåŸŸé‡Œæ‰€æœ‰çš„ `'O'` ç”¨ `'X'` å¡«å……ã€‚

**ç¤ºä¾‹ï¼š**

![è¢«å›´ç»•çš„åŒºåŸŸ å›¾æºLeetCode](https://store.southyang.cn/LeetCode/UnionFind/xogrid.jpg)

```
è¾“å…¥ï¼šboard = [["X","X","X","X"],["X","O","O","X"],["X","X","O","X"],["X","O","X","X"]]
è¾“å‡ºï¼š[["X","X","X","X"],["X","X","X","X"],["X","X","X","X"],["X","O","X","X"]]
è§£é‡Šï¼šè¢«å›´ç»•çš„åŒºé—´ä¸ä¼šå­˜åœ¨äºè¾¹ç•Œä¸Šï¼Œæ¢å¥è¯è¯´ï¼Œä»»ä½•è¾¹ç•Œä¸Šçš„Â 'O'Â éƒ½ä¸ä¼šè¢«å¡«å……ä¸ºÂ 'X'ã€‚ ä»»ä½•ä¸åœ¨è¾¹ç•Œä¸Šï¼Œæˆ–ä¸ä¸è¾¹ç•Œä¸Šçš„Â 'O'Â ç›¸è¿çš„Â 'O'Â æœ€ç»ˆéƒ½ä¼šè¢«å¡«å……ä¸ºÂ 'X'ã€‚å¦‚æœä¸¤ä¸ªå…ƒç´ åœ¨æ°´å¹³æˆ–å‚ç›´æ–¹å‘ç›¸é‚»ï¼Œåˆ™ç§°å®ƒä»¬æ˜¯â€œç›¸è¿â€çš„ã€‚
```

```
è¾“å…¥ï¼šboard = [["X"]]
è¾“å‡ºï¼š[["X"]]
```

**æç¤ºï¼š**

- `m == board.length`
- `n == board[i].length`
- `1 <= m, n <= 200`
- `board[i][j]` ä¸º `'X'` æˆ– `'O'`

**è§£é¢˜æ€è·¯ï¼š**

- `O`æœ‰ä¸¤ç§å­˜åœ¨çŠ¶æ€
  - çŠ¶æ€ä¸€ï¼šè¢«Xå›´ç»•
  - çŠ¶æ€äºŒï¼šä¸è¾¹ç•Œç›¸è¿ï¼Œä¸è¢«Xå›´ç»•
- é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡å¹¶æŸ¥é›†å°†è¿™ä¸¤ç§çŠ¶æ€çš„`O`åŒºåˆ†å‡ºæ¥
- å®šä¹‰ä¸€ä¸ªå…¬å…±çš„ç¥–å®—ç»“ç‚¹`flag`ï¼Œå°†æ‰€æœ‰çš„è¾¹ç•Œ`O`å…¨éƒ¨åˆå¹¶åˆ°`flag`ä¸Š
- å½“æˆ‘ä»¬åœ¨çŸ©é˜µå†…éƒ¨è¿›è¡Œéå†æ—¶ï¼Œé‡åˆ°ä¸¤ä¸ªç›¸è¿çš„`O`ï¼Œåˆå¹¶ä¸”åˆ¤æ–­æ˜¯å¦æœ‰ç¥–å®—ç»“ç‚¹ä¸º`flag`çš„ç‚¹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™å¦ä¸€ä¸ª`O`ç‚¹ä¹Ÿåˆå¹¶åˆ°`flag`ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯æ‰€æœ‰ä¸è¾¹ç•Œç›¸è¿çš„`O`ç‚¹çš„ç¥–å®—ç»“ç‚¹å‡ä¸º`flag`
- æœ€ç»ˆéå†çŸ©é˜µï¼Œå¦‚æœ`O`ç‚¹çš„ç¥–å®—ç»“ç‚¹ä¸º`flag`ï¼Œå°†å…¶æ”¹ä¸º`X`

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent;
    int flag;

    void initUnion(int len){
        parent.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){
        int pa = find(a), pb = find(b);
        if(pa == pb){
            return;
        }
        if(pa == flag){ // æ‰‹åŠ¨ç»´æŒç¥–å®—ç»“ç‚¹ä¸ºflag
            parent[pb] = pa;
        }
        else{
            parent[pa] = pb;
        }
    }

    void solve(vector<vector<char>>& board) {
        int m = board.size();
        int n = board[0].size();
        flag = m * n;

        initUnion(m * n + 1);

        for(int i = 0; i < m; i ++){
            for(int j = 0; j < n; j ++){
                if(board[i][j] == 'X'){
                    continue;
                }
                if(i == 0 || j == 0 || i == m - 1 || j == n - 1){
                    merge(m * n, i * n + j);
                }
                if(i > 0 && board[i - 1][j] == 'O'){ // åªéœ€è¦åˆ¤æ–­ä¸Šè¾¹å’Œå·¦è¾¹çš„åŸå› ï¼šè¿™ä¸¤ä¸ªæ–¹å‘çš„å…ƒç´ å·²ç»è¢«åˆ¤æ–­è¿‡äº†
                    merge((i - 1) * n + j, i * n + j);
                }
                if(j > 0 && board[i][j - 1] == 'O'){
                    merge(i * n + j - 1, i * n + j);
                }
            }
        }

        for(int i = 0; i < m; i ++){ // æ‰¾åˆ°ç¥–å®—ç»“ç‚¹ä¸ä¸ºflagçš„ O ï¼Œ å°†å…¶ä¿®æ”¹ä¸º X
            for(int j = 0; j < n; j ++){
                if(board[i][j] == 'O'  && find(i * n + j) != flag){
                    board[i][j] = 'X';
                }
            }
        }
    }   
};
```



### 721. è´¦æˆ·åˆå¹¶ <span id="721"></span> ğŸ¤¦â€â™‚ï¸ğŸ¤¦â€â™‚ï¸

**éš¾åº¦ï¼š**<font color=#ffa119>ä¸­ç­‰</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªåˆ—è¡¨ `accounts`ï¼Œæ¯ä¸ªå…ƒç´  `accounts[i]` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´  `accounts[i][0]` æ˜¯ *åç§° (name)*ï¼Œå…¶ä½™å…ƒç´ æ˜¯ ***emails*** è¡¨ç¤ºè¯¥è´¦æˆ·çš„é‚®ç®±åœ°å€ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³åˆå¹¶è¿™äº›è´¦æˆ·ã€‚å¦‚æœä¸¤ä¸ªè´¦æˆ·éƒ½æœ‰ä¸€äº›å…±åŒçš„é‚®ç®±åœ°å€ï¼Œåˆ™ä¸¤ä¸ªè´¦æˆ·å¿…å®šå±äºåŒä¸€ä¸ªäººã€‚è¯·æ³¨æ„ï¼Œå³ä½¿ä¸¤ä¸ªè´¦æˆ·å…·æœ‰ç›¸åŒçš„åç§°ï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½å±äºä¸åŒçš„äººï¼Œå› ä¸ºäººä»¬å¯èƒ½å…·æœ‰ç›¸åŒçš„åç§°ã€‚ä¸€ä¸ªäººæœ€åˆå¯ä»¥æ‹¥æœ‰ä»»æ„æ•°é‡çš„è´¦æˆ·ï¼Œä½†å…¶æ‰€æœ‰è´¦æˆ·éƒ½å…·æœ‰ç›¸åŒçš„åç§°ã€‚

åˆå¹¶è´¦æˆ·åï¼ŒæŒ‰ä»¥ä¸‹æ ¼å¼è¿”å›è´¦æˆ·ï¼šæ¯ä¸ªè´¦æˆ·çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯åç§°ï¼Œå…¶ä½™å…ƒç´ æ˜¯ **æŒ‰å­—ç¬¦ ASCII é¡ºåºæ’åˆ—** çš„é‚®ç®±åœ°å€ã€‚è´¦æˆ·æœ¬èº«å¯ä»¥ä»¥ **ä»»æ„é¡ºåº** è¿”å›ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šaccounts = [["John", "johnsmith@mail.com", "john00@mail.com"], ["John", "johnnybravo@mail.com"], ["John", "johnsmith@mail.com", "john_newyork@mail.com"], ["Mary", "mary@mail.com"]]

è¾“å‡ºï¼š[["John", 'john00@mail.com', 'john_newyork@mail.com', 'johnsmith@mail.com'],  ["John", "johnnybravo@mail.com"], ["Mary", "mary@mail.com"]]

è§£é‡Šï¼š
ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ª John æ˜¯åŒä¸€ä¸ªäººï¼Œå› ä¸ºä»–ä»¬æœ‰å…±åŒçš„é‚®ç®±åœ°å€ "johnsmith@mail.com"ã€‚ 
ç¬¬äºŒä¸ª John å’Œ Mary æ˜¯ä¸åŒçš„äººï¼Œå› ä¸ºä»–ä»¬çš„é‚®ç®±åœ°å€æ²¡æœ‰è¢«å…¶ä»–å¸æˆ·ä½¿ç”¨ã€‚
å¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›è¿™äº›åˆ—è¡¨ï¼Œä¾‹å¦‚ç­”æ¡ˆ [['Mary'ï¼Œ'mary@mail.com']ï¼Œ['John'ï¼Œ'johnnybravo@mail.com']ï¼Œ
['John'ï¼Œ'john00@mail.com'ï¼Œ'john_newyork@mail.com'ï¼Œ'johnsmith@mail.com']] ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚
```

```
è¾“å…¥ï¼šaccounts = [["Gabe","Gabe0@m.co","Gabe3@m.co","Gabe1@m.co"],["Kevin","Kevin3@m.co","Kevin5@m.co","Kevin0@m.co"],["Ethan","Ethan5@m.co","Ethan4@m.co","Ethan0@m.co"],["Hanzo","Hanzo3@m.co","Hanzo1@m.co","Hanzo0@m.co"],["Fern","Fern5@m.co","Fern1@m.co","Fern0@m.co"]]

è¾“å‡ºï¼š[["Ethan","Ethan0@m.co","Ethan4@m.co","Ethan5@m.co"],["Gabe","Gabe0@m.co","Gabe1@m.co","Gabe3@m.co"],["Hanzo","Hanzo0@m.co","Hanzo1@m.co","Hanzo3@m.co"],["Kevin","Kevin0@m.co","Kevin3@m.co","Kevin5@m.co"],["Fern","Fern0@m.co","Fern1@m.co","Fern5@m.co"]]
```

**æç¤ºï¼š**

- `1 <= accounts.length <= 1000`
- `2 <= accounts[i].length <= 10`
- `1 <= accounts[i][j].length <= 30`
- `accounts[i][0]` ç”±è‹±æ–‡å­—æ¯ç»„æˆ
- `accounts[i][j] (for j > 0)` æ˜¯æœ‰æ•ˆçš„é‚®ç®±åœ°å€

**è§£é¢˜æ€è·¯ï¼š**

- è¿™é“é¢˜çš„é€»è¾‘éƒ¨åˆ†æ˜¯å®Œå…¨çœ‹[å®˜æ–¹é¢˜è§£](https://leetcode.cn/problems/accounts-merge/solution/zhang-hu-he-bing-by-leetcode-solution-3dyq/)çš„ï¼Œä¸»è¦æ˜¯è‡ªå·±å¼€å§‹æ²¡æœ‰ä½¿ç”¨å¼•ç”¨ï¼Œä¸€ç›´è¶…æ—¶ï¼Œçœ‹äº†å®˜æ–¹é¢˜è§£ï¼ŒæŠŠæ‰€æœ‰çš„å®šä¹‰å˜é‡éƒ½å˜æˆäº†å¼•ç”¨ï¼Œæ‰å‹‰å¼ºé€šè¿‡
- å…¶å®æ•´ä½“é€»è¾‘æ˜¯ä¸éš¾çš„
  - é¦–å…ˆæˆ‘ä»¬ç»´æŠ¤ä¸¤ä¸ª`map`ç”¨æ¥å­˜æ”¾`email`å’Œ`name`ã€`index`çš„å¯¹åº”å…³ç³»ï¼›ç”¨`emailsCount`æ¥è®°å½•æ€»çš„emailæ•°é‡
  - å› ä¸ºåœ¨ä¸¤ä¸ª`map`ä¸­æˆ‘ä»¬éƒ½æ˜¯ç”¨`email`ä½œä¸ºé”®å€¼ï¼Œè€Œé”®å€¼ä¸èƒ½é‡å¤ï¼Œå› æ­¤åœ¨ç»´æŠ¤çš„å¹¶æŸ¥é›†é‡Œï¼Œä¹Ÿè¦ç”¨æ— é‡å¤çš„`email`æ•°é‡æ¥åˆå§‹åŒ–ï¼Œå³`emailsCount`
  - åˆå§‹åŒ–å¹¶æŸ¥é›†ä¹‹åï¼Œå¯¹`accounts`è¿›è¡Œéå†ï¼Œå¯¹äº`accounts`ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ `account`ï¼Œæˆ‘ä»¬è¦å°†å…¶ä¸­çš„æ‰€æœ‰`email`éƒ½æ”¾å…¥åŒä¸€ä¸ªå­åŒºé—´ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†åˆå¹¶åçš„å¹¶æŸ¥é›†ï¼ŒåŒä¸€ä¸ªäººçš„æ‰€æœ‰è´¦æˆ·éƒ½è¢«æ”¾å…¥äº†åŒä¸€ä¸ªå­åŒºé—´
  - ä¹‹åæˆ‘ä»¬å†ç»´æŠ¤ä¸€ä¸ª`map`æ¥å­˜æ”¾`index`å’Œ`emails`çš„å¯¹åº”å…³ç³»ï¼Œæ¯ä¸ª`email`éƒ½æœ‰å”¯ä¸€çš„ç¥–å®—ç»“ç‚¹ï¼Œå…¶ç´¢å¼•å°±æ˜¯`index`
    - é€šè¿‡ä»`emailToIndex`ä¸­ä¸æ–­å–å‡º`email`ï¼Œæ‰¾åˆ°è¯¥`email`çš„ç¥–å®—ç»“ç‚¹ç´¢å¼•`index`åï¼ŒåŠ åˆ°`indexToEmails[index]`ä¸­
  - ä»è€Œæˆ‘ä»¬å¾—åˆ°äº†`index`å’Œ`index`å¯¹åº”çš„æ‰€æœ‰`emails`ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªäººçš„æ‰€æœ‰è´¦æˆ·éƒ½å·²ç»æ”¾åˆ°äº†ä¸€èµ·
  - é¢˜ç›®è¦æ±‚æŒ‰ç…§`ASCII`é¡ºåºè¿”å›ï¼Œåšä¸€ä¸ª`sort`å³å¯
  - éšä¾¿æ‹¿åˆ°ä¸€ä¸ª`email`ï¼Œä»`emailToName`ä¸­å¾—åˆ°`name`ï¼Œå†å’Œ`emails`ä¸€èµ·ä½œä¸º`vector<string>`ç±»å‹çš„æ•°æ®å‹å…¥æœ€ç»ˆçš„`res`
  - è¿”å›`res`

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent;   

    int find(int x){ // æ‰¾åˆ°ç¥–å®—ç»“ç‚¹
        if (parent[x] != x){ // åšè·¯å¾„å‹ç¼©
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){ // åˆå¹¶ä¸¤ä¸ªåŒºé—´ï¼Œå°†aå¹¶åˆ°bä¸Š
        parent[find(b)] = find(a);
    }

    void initUnion(int length){ // åˆå§‹åŒ–å¹¶æŸ¥é›†
        parent.resize(length);
        for(int i = 0; i < length; i ++){
            parent[i] = i;
        }
    }

    vector<vector<string>> accountsMerge(vector<vector<string>>& accounts) {
        // é¦–å…ˆç”¨ä¸¤ä¸ªmapæ¥å­˜å‚¨ emailToName å’Œ emailToIndex
        // åˆ†åˆ«ä¸ºemailå¯¹åº”çš„nameå’Œemailå¯¹åº”çš„ç¼–å·
        map<string, int> emailToIndex;
        map<string, string> emailToName;
        // ç”¨emailCountæ¥å­˜å‚¨emailçš„ç¼–å·
        int emailsCount = 0;

        // ç”ŸæˆemailToNameå’ŒemailToIndex
        for (auto& account : accounts) {
            string& name = account[0];
            int length = account.size();
            for (int i = 1; i < length; i ++) {
                string& email = account[i];
                if (!emailToName.count(email)) {
                    emailToIndex[email] = emailsCount++;
                    emailToName[email] = name;
                }
            }
        }
        // åˆå§‹åŒ–å¹¶æŸ¥é›†
        initUnion(emailsCount);
        // åˆå¹¶å¹¶æŸ¥é›†
        for(auto& account: accounts){
            string& preEmail = account[1];
            int preIndex = emailToIndex[preEmail];
            int length = account.size();
            for (int i = 2; i < length; i ++) {
                string& nextEmail = account[i];
                int nextIndex = emailToIndex[nextEmail];
                merge(preIndex, nextIndex);
            }
        }
        // æ„å»ºindexToEmailsï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡indexæ¥è·å–æ‰€æœ‰çš„email
        map<int, vector<string>> indexToEmails;
        for (auto& iter : emailToIndex) {
            int index = find(iter.second);
            vector<string>& account = indexToEmails[index];
            account.emplace_back(iter.first);
            indexToEmails[index] = account;
        }
        // æ„å»ºè¿”å›æ•°ç»„
        vector<vector<string>> res;
        for (auto& iter : indexToEmails) {
            sort(iter.second.begin(), iter.second.end());
            string& name = emailToName[iter.second[0]];
            vector<string> account;
            account.emplace_back(name);
            for (auto& email : iter.second) {
                account.emplace_back(email);
            }
            res.emplace_back(account);
        }
        return res;
    }
};
```



### 765. æƒ…ä¾£ç‰µæ‰‹ <span id="765"></span>

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

`n` å¯¹æƒ…ä¾£ååœ¨è¿ç»­æ’åˆ—çš„ `2n` ä¸ªåº§ä½ä¸Šï¼Œæƒ³è¦ç‰µåˆ°å¯¹æ–¹çš„æ‰‹ã€‚

äººå’Œåº§ä½ç”±ä¸€ä¸ªæ•´æ•°æ•°ç»„ `row` è¡¨ç¤ºï¼Œå…¶ä¸­ `row[i]` æ˜¯ååœ¨ç¬¬ `i `ä¸ªåº§ä½ä¸Šçš„äººçš„ **ID**ã€‚æƒ…ä¾£ä»¬æŒ‰é¡ºåºç¼–å·ï¼Œç¬¬ä¸€å¯¹æ˜¯ `(0, 1)`ï¼Œç¬¬äºŒå¯¹æ˜¯ `(2, 3)`ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€åä¸€å¯¹æ˜¯ `(2n-2, 2n-1)`ã€‚

è¿”å› *æœ€å°‘äº¤æ¢åº§ä½çš„æ¬¡æ•°ï¼Œä»¥ä¾¿æ¯å¯¹æƒ…ä¾£å¯ä»¥å¹¶è‚©ååœ¨ä¸€èµ·*ã€‚ *æ¯æ¬¡*äº¤æ¢å¯é€‰æ‹©ä»»æ„ä¸¤äººï¼Œè®©ä»–ä»¬ç«™èµ·æ¥äº¤æ¢åº§ä½ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥: row = [0,2,1,3]
è¾“å‡º: 1
è§£é‡Š: åªéœ€è¦äº¤æ¢row[1]å’Œrow[2]çš„ä½ç½®å³å¯ã€‚
```

```
è¾“å…¥: row = [3,2,0,1]
è¾“å‡º: 0
è§£é‡Š: æ— éœ€äº¤æ¢åº§ä½ï¼Œæ‰€æœ‰çš„æƒ…ä¾£éƒ½å·²ç»å¯ä»¥æ‰‹ç‰µæ‰‹äº†ã€‚
```

**æç¤ºï¼š**

- `2n == row.length`
- `2 <= n <= 30`
- `n` æ˜¯å¶æ•°
- `0 <= row[i] < 2n`
- `row` ä¸­æ‰€æœ‰å…ƒç´ å‡**æ— é‡å¤**

**è§£é¢˜æ€è·¯ï¼š**

- å½“æˆ‘ä»¬æƒ³è¦è®©ä¸€å¯¹æƒ…ä¾£ååœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œä¸€å…±ä¼šå½±å“å››ä¸ªäººçš„ä½ç½®å…³ç³»
- ä¾‹å¦‚ï¼Œabååœ¨ä¸€èµ·ï¼Œcdååœ¨ä¸€èµ·ï¼Œå½“æˆ‘ä»¬æƒ³è¦è®©acååœ¨ä¸€èµ·æ—¶ï¼Œè°ƒæ•´çš„ç»“æœå°±æ˜¯acå’Œbd
- é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°4ä¸ªäººæœ€å¤šäº¤æ¢ä¸€æ¬¡å°±å¯ä»¥æ»¡è¶³æ¡ä»¶ï¼›6ä¸ªäººæœ€å¤šäº¤æ¢2æ¬¡å°±å¯ä»¥æ»¡è¶³æ¡ä»¶ï¼Œä»¥æ­¤ç±»æ¨
- ç»“åˆå¹¶æŸ¥é›†ï¼Œåˆå§‹æƒ…å†µä¸­ï¼Œä¸€ä¸ªå­åŒºé—´æœ‰ä¸¤ä¸ªäººï¼Œå‡è®¾å…±ä¸¤ä¸ªå­åŒºé—´ï¼Œæƒ³è¦æ»¡è¶³æ¡ä»¶ï¼Œè‡³å¤šéœ€è¦äº¤æ¢ä¸€æ¬¡åº§ä½ï¼Œå³åˆå¹¶ä¸€æ¬¡å­åŒºé—´ï¼›ä¸‰ä¸ªå­åŒºé—´è‡³å¤šåˆå¹¶ä¸¤æ¬¡ï¼›ä»¥æ­¤ç±»æ¨
- æ•´ä½“é€»è¾‘
  - é¦–å…ˆåˆå§‹åŒ–å¹¶æŸ¥é›†
  - åšç¬¬ä¸€æ­¥åˆå¹¶ï¼šè®©æ¯ä¸€å¯¹æƒ…ä¾£åœ¨åŒä¸€ä¸ªå­åŒºé—´ï¼Œå³ï¼ˆ0ï¼Œ1ï¼‰ï¼ˆ2ï¼Œ3ï¼‰â€¦â€¦
  - ç¬¬äºŒæ­¥åˆå¹¶ï¼š
    - éå†numsï¼Œä¸¤ä¸¤ä¸€ç»„
    - æ£€æŸ¥nums[i]å’Œnums[i + 1]æ˜¯å¦åœ¨åŒä¸€ä¸ªåŒºé—´ï¼Œä¸åœ¨å°±åˆå¹¶ï¼Œåœ¨å°±ç»§ç»­éå†
    - ç»Ÿè®¡åˆå¹¶æ¬¡æ•°
  - è¿”å›åˆå¹¶æ¬¡æ•°

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent;
    void initUnion(int length){
        parent.resize(length);  
        for(int i = 0; i < length; i ++){
            parent[i] = i;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){
        parent[find(b)] = find(a);
    }

    int minSwapsCouples(vector<int>& row) {
        int length = row.size();
        initUnion(length);
        int count = 0;

        int i = 0;
        while(i < length){ // å…ˆå°†æ¯ä¸€å¯¹æƒ…ä¾£æ”¾å…¥ä¸€ä¸ªå­åŒºé—´
            merge(i, i + 1);
            i = i + 2;
        }
        
        i = 0;
        while(i < length){ // ä»å¤´åˆ°å°¾ä¸¤ä¸¤éå†ï¼Œå¦‚æœå½“å‰ä¸€å¯¹ä¸æ˜¯ä¸€ä¸ªåŒºé—´çš„ï¼Œé‚£ä¹ˆå°±æŠŠä»–ä»¬æ‰€åœ¨åŒºé—´åˆå¹¶ï¼Œå¹¶è®°å½•åˆå¹¶æ¬¡æ•°
            if(find(row[i]) != find(row[i + 1])){
                merge(row[i], row[i + 1]);
                count++;
            }
            i = i + 2;
        }
        return count;   
    }
};
```



### 778. æ°´ä½ä¸Šå‡çš„æ³³æ± ä¸­æ¸¸æ³³ <span id="778"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

åœ¨ä¸€ä¸ª `n x n` çš„æ•´æ•°çŸ©é˜µ `grid` ä¸­ï¼Œæ¯ä¸€ä¸ªæ–¹æ ¼çš„å€¼ `grid[i][j]` è¡¨ç¤ºä½ç½® `(i, j)` çš„å¹³å°é«˜åº¦ã€‚

å½“å¼€å§‹ä¸‹é›¨æ—¶ï¼Œåœ¨æ—¶é—´ä¸º `t` æ—¶ï¼Œæ°´æ± ä¸­çš„æ°´ä½ä¸º `t` ã€‚ä½ å¯ä»¥ä»ä¸€ä¸ªå¹³å°æ¸¸å‘å››å‘¨ç›¸é‚»çš„ä»»æ„ä¸€ä¸ªå¹³å°ï¼Œä½†æ˜¯å‰ææ˜¯æ­¤æ—¶æ°´ä½å¿…é¡»åŒæ—¶æ·¹æ²¡è¿™ä¸¤ä¸ªå¹³å°ã€‚å‡å®šä½ å¯ä»¥ç¬é—´ç§»åŠ¨æ— é™è·ç¦»ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤åœ¨æ–¹æ ¼å†…éƒ¨æ¸¸åŠ¨æ˜¯ä¸è€—æ—¶çš„ã€‚å½“ç„¶ï¼Œåœ¨ä½ æ¸¸æ³³çš„æ—¶å€™ä½ å¿…é¡»å¾…åœ¨åæ ‡æ–¹æ ¼é‡Œé¢ã€‚

ä½ ä»åæ ‡æ–¹æ ¼çš„å·¦ä¸Šå¹³å° `(0ï¼Œ0)` å‡ºå‘ã€‚è¿”å› *ä½ åˆ°è¾¾åæ ‡æ–¹æ ¼çš„å³ä¸‹å¹³å° `(n-1, n-1)` æ‰€éœ€çš„æœ€å°‘æ—¶é—´ ã€‚*

**ç¤ºä¾‹ï¼š**

![æ°´ä½ä¸Šå‡çš„æ³³æ± ä¸­æ¸¸æ³³](https://store.southyang.cn/LeetCode/UnionFind/swim1-grid.jpg)

```
è¾“å…¥: grid = [[0,2],[1,3]]
è¾“å‡º: 3
è§£é‡Š:
æ—¶é—´ä¸º0æ—¶ï¼Œä½ ä½äºåæ ‡æ–¹æ ¼çš„ä½ç½®ä¸º (0, 0)ã€‚
æ­¤æ—¶ä½ ä¸èƒ½æ¸¸å‘ä»»æ„æ–¹å‘ï¼Œå› ä¸ºå››ä¸ªç›¸é‚»æ–¹å‘å¹³å°çš„é«˜åº¦éƒ½å¤§äºå½“å‰æ—¶é—´ä¸º 0 æ—¶çš„æ°´ä½ã€‚
ç­‰æ—¶é—´åˆ°è¾¾ 3 æ—¶ï¼Œä½ æ‰å¯ä»¥æ¸¸å‘å¹³å° (1, 1). å› ä¸ºæ­¤æ—¶çš„æ°´ä½æ˜¯ 3ï¼Œåæ ‡æ–¹æ ¼ä¸­çš„å¹³å°æ²¡æœ‰æ¯”æ°´ä½ 3 æ›´é«˜çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ¸¸å‘åæ ‡æ–¹æ ¼ä¸­çš„ä»»æ„ä½ç½®
```
![æ°´ä½ä¸Šå‡çš„æ³³æ± ä¸­æ¸¸æ³³](https://store.southyang.cn/LeetCode/UnionFind/swim2-grid-1.jpg)
```
è¾“å…¥: grid = [[0,1,2,3,4],[24,23,22,21,5],[12,13,14,15,16],[11,17,18,19,20],[10,9,8,7,6]]
è¾“å‡º: 16
è§£é‡Š: æœ€ç»ˆçš„è·¯çº¿ç”¨åŠ ç²—è¿›è¡Œäº†æ ‡è®°ã€‚
æˆ‘ä»¬å¿…é¡»ç­‰åˆ°æ—¶é—´ä¸º 16ï¼Œæ­¤æ—¶æ‰èƒ½ä¿è¯å¹³å° (0, 0) å’Œ (4, 4) æ˜¯è¿é€šçš„
```

**æç¤ºï¼š**

- `n == grid.length`
- `n == grid[i].length`
- `1 <= n <= 50`
- `0 <= grid[i][j] < n2`
- `grid[i][j]` ä¸­æ¯ä¸ªå€¼ **å‡æ— é‡å¤**

**è§£é¢˜æ€è·¯ï¼š**

- è¿™é“é¢˜è§£æ³•çš„å¦™å¤„åœ¨äºï¼Œ`t`ç§’çš„æ°´ä½ä¸º`t`ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰¾åˆ°é«˜åº¦ä¸º`t`çš„å¹³å°ï¼ŒæŸ¥çœ‹è¯¥å¹³å°å‘¨å›´çš„å››ä¸ªæ–¹å‘ï¼Œ æ˜¯å¦æœ‰é«˜åº¦ä½äº`t`çš„ï¼Œå¦‚æœæœ‰ï¼Œå°±åˆå¹¶ä¸ºä¸€ä¸ªåŒºé—´
- é«˜åº¦ä»ä½åˆ°é«˜éå†å¹³å°ï¼Œä¿è¯ç¬¦åˆå½“å‰æ°´ä½çš„å¹³å°ä¸€å®šéƒ½è¢«éå†è¿‡ï¼Œä¸”å»ºç«‹äº†æ­£ç¡®çš„å­åŒºé—´
- å½“åœ¨éå†è¿‡ç¨‹ä¸­å‘ç°ï¼Œ`(0, 0)`å’Œ`(n-1, n-1)`å¹³å°åœ¨åŒä¸€åŒºé—´å†…ï¼Œåˆ™è¿”å›æ°´ä½å³å¯

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    int sideLength;
    vector<pair<int, int>> directions{{0, 1}, {0, -1}, {1, 0}, {-1, 0}};
    vector<int> parent;

    int getIndex(int i, int j){
        return i * sideLength + j;
    }

    void initUnion(int len){
        parent.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){
        parent[find(b)] = find(a);
    }

    int swimInWater(vector<vector<int>>& grid) {
        sideLength = grid.size();
        int allLength = sideLength * sideLength;

        int index[allLength];
        for(int i = 0; i < sideLength; i ++){ // å°†æ¯ä¸ªä½ç½®çš„é«˜åº¦å’Œåæ ‡å¯¹åº”å­˜å…¥index
            for(int j = 0; j < sideLength; j ++){
                index[grid[i][j]] = getIndex(i, j);
            }
        }

        initUnion(allLength);

        for(int i = 0; i < allLength; i ++){
            // è·å–å’Œå½“å‰æ°´ä½é«˜åº¦ç›¸åŒç‚¹çš„åæ ‡
            int x = index[i] / sideLength;
            int y = index[i] % sideLength;

            for(const auto& dir: directions){
                // è·å–æ–°çš„ç‚¹
                int newx = x + dir.first, newy = y + dir.second;
                // åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼šæ˜¯å¦åœ¨çŸ©é˜µå†… && é«˜åº¦æ˜¯å¦ä½äºæ°´ä½
                if(newx >= 0 && newx < sideLength && newy >= 0 && newy < sideLength && grid[newx][newy] <= i){
                    merge(index[i], getIndex(newx, newy));
                }

                if(find(0) == find(allLength - 1)){
                    return i;
                }
            }
        }

        return -1;
    }
};
```



### 803. æ‰“ç –å— <span id="803"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

æœ‰ä¸€ä¸ª `m x n` çš„äºŒå…ƒç½‘æ ¼ `grid` ï¼Œå…¶ä¸­ `1` è¡¨ç¤ºç –å—ï¼Œ`0` è¡¨ç¤ºç©ºç™½ã€‚ç –å— **ç¨³å®š**ï¼ˆä¸ä¼šæ‰è½ï¼‰çš„å‰ææ˜¯ï¼š

- ä¸€å—ç –ç›´æ¥è¿æ¥åˆ°ç½‘æ ¼çš„é¡¶éƒ¨ï¼Œæˆ–è€…
- è‡³å°‘æœ‰ä¸€å—ç›¸é‚»ï¼ˆ4 ä¸ªæ–¹å‘ä¹‹ä¸€ï¼‰ç –å— **ç¨³å®š** ä¸ä¼šæ‰è½æ—¶

ç»™ä½ ä¸€ä¸ªæ•°ç»„ `hits` ï¼Œè¿™æ˜¯éœ€è¦ä¾æ¬¡æ¶ˆé™¤ç –å—çš„ä½ç½®ã€‚æ¯å½“æ¶ˆé™¤ `hits[i] = (rowi, coli)` ä½ç½®ä¸Šçš„ç –å—æ—¶ï¼Œå¯¹åº”ä½ç½®çš„ç –å—ï¼ˆè‹¥å­˜åœ¨ï¼‰ä¼šæ¶ˆå¤±ï¼Œç„¶åå…¶ä»–çš„ç –å—å¯èƒ½å› ä¸ºè¿™ä¸€æ¶ˆé™¤æ“ä½œè€Œ **æ‰è½** ã€‚ä¸€æ—¦ç –å—æ‰è½ï¼Œå®ƒä¼š **ç«‹å³** ä»ç½‘æ ¼ `grid` ä¸­æ¶ˆå¤±ï¼ˆå³ï¼Œå®ƒä¸ä¼šè½åœ¨å…¶ä»–ç¨³å®šçš„ç –å—ä¸Šï¼‰ã€‚

è¿”å›ä¸€ä¸ªæ•°ç»„ `result` ï¼Œå…¶ä¸­ `result[i]` è¡¨ç¤ºç¬¬ `i` æ¬¡æ¶ˆé™¤æ“ä½œå¯¹åº”æ‰è½çš„ç –å—æ•°ç›®ã€‚

**æ³¨æ„**ï¼Œæ¶ˆé™¤å¯èƒ½æŒ‡å‘æ˜¯æ²¡æœ‰ç –å—çš„ç©ºç™½ä½ç½®ï¼Œå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œåˆ™æ²¡æœ‰ç –å—æ‰è½ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šgrid = [[1,0,0,0],[1,1,1,0]], hits = [[1,0]]
è¾“å‡ºï¼š[2]
è§£é‡Šï¼šç½‘æ ¼å¼€å§‹ä¸ºï¼š
[[1,0,0,0]ï¼Œ
 [1,1,1,0]]
æ¶ˆé™¤ (1,0) å¤„åŠ ç²—çš„ç –å—ï¼Œå¾—åˆ°ç½‘æ ¼ï¼š
[[1,0,0,0]
 [0,1,1,0]]
ä¸¤ä¸ªåŠ ç²—çš„ç –ä¸å†ç¨³å®šï¼Œå› ä¸ºå®ƒä»¬ä¸å†ä¸é¡¶éƒ¨ç›¸è¿ï¼Œä¹Ÿä¸å†ä¸å¦ä¸€ä¸ªç¨³å®šçš„ç –ç›¸é‚»ï¼Œå› æ­¤å®ƒä»¬å°†æ‰è½ã€‚å¾—åˆ°ç½‘æ ¼ï¼š
[[1,0,0,0],
 [0,0,0,0]]
å› æ­¤ï¼Œç»“æœä¸º [2] ã€‚
```

```
è¾“å…¥ï¼šgrid = [[1,0,0,0],[1,1,0,0]], hits = [[1,1],[1,0]]
è¾“å‡ºï¼š[0,0]
è§£é‡Šï¼šç½‘æ ¼å¼€å§‹ä¸ºï¼š
[[1,0,0,0],
 [1,1,0,0]]
æ¶ˆé™¤ (1,1) å¤„åŠ ç²—çš„ç –å—ï¼Œå¾—åˆ°ç½‘æ ¼ï¼š
[[1,0,0,0],
 [1,0,0,0]]
å‰©ä¸‹çš„ç –éƒ½å¾ˆç¨³å®šï¼Œæ‰€ä»¥ä¸ä¼šæ‰è½ã€‚ç½‘æ ¼ä¿æŒä¸å˜ï¼š
[[1,0,0,0], 
 [1,0,0,0]]
æ¥ä¸‹æ¥æ¶ˆé™¤ (1,0) å¤„åŠ ç²—çš„ç –å—ï¼Œå¾—åˆ°ç½‘æ ¼ï¼š
[[1,0,0,0],
 [0,0,0,0]]
å‰©ä¸‹çš„ç –å—ä»ç„¶æ˜¯ç¨³å®šçš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ç –å—æ‰è½ã€‚
å› æ­¤ï¼Œç»“æœä¸º [0,0] ã€‚
```

**æç¤ºï¼š**

- `m == grid.length`
- `n == grid[i].length`
- `1 <= m, n <= 200`
- `grid[i][j]` ä¸º `0` æˆ– `1`
- `1 <= hits.length <= 4 * 104`
- `hits[i].length == 2`
- `0 <= xi <= m - 1`
- `0 <= yi <= n - 1`
- æ‰€æœ‰ `(xi, yi)` äº’ä¸ç›¸åŒ

**è§£é¢˜æ€è·¯ï¼š**

- é€†å‘æ€ç»´ï¼Œå¹¶æŸ¥é›†æ˜¯åˆå¹¶åŒºé—´ï¼Œä½†è¿™é“é¢˜æ˜¯åˆ†ç¦»åŒºé—´ï¼›é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠåˆ†ç¦»é€†å‘ä¸ºåˆå¹¶å³å¯
- ä¸»è¦é€»è¾‘
  - å®šä¹‰tempGridæ¥å­˜æ”¾å®Œå…¨åˆ†ç¦»åçš„åŒºé—´ï¼Œå³å°†æ¶ˆé™¤æ‰çš„åœ°æ–¹å…¨éƒ¨ç½®ä¸º0
  - åˆå§‹åŒ–å¹¶æŸ¥é›†ï¼Œå¹¶æ ¹æ®æœ€åˆçš„tempGridæ¥å»ºç«‹å¹¶æŸ¥é›†
    - å®šä¹‰ä¸€ä¸ªroofæ¥ä½œä¸ºå±‹é¡¶ç»“ç‚¹ï¼Œæœ€é¡¶å±‚çš„ç –å—é¦–å…ˆå’Œå±‹é¡¶è¿ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä»£è¡¨æœ€åˆå§‹çš„ç¨³å®šåŒºé—´
    - å…¶æ¬¡éå†å…¶ä»–å±‚çš„ç –å—ï¼Œå»ºç«‹ç›¸åº”çš„åŒºé—´
  - ä»åå¾€å‰éå†æ¶ˆé™¤ç –å—ï¼Œå¡«è¡¥ç©ºç¼ºåï¼Œè§‚å¯Ÿæœ‰æ— å­åŒºé—´å¯ä»¥åˆå¹¶
    - å¦‚æœåœ¨gridä¸­çš„ä½ç½®æ˜¯ç©ºï¼Œé‚£ä¹ˆç›´æ¥å‹å…¥0å³å¯ï¼Œä¸€å®šæ²¡æœ‰ç –å—å—å½±å“
    - åˆå¹¶çš„ä¸»ä»ä½ç½®ä¸å½±å“æœ€åæ“ä½œ
    - å®šä¹‰getSize()å‡½æ•°æ¥è·å–æ¯ä¸ªå…ƒç´ æ‰€åœ¨åŒºé—´çš„å…ƒç´ ä¸ªæ•°ï¼Œå› æ­¤ä¸å—ä¸»ä»ä½ç½®çš„å½±å“
- æœ€ç»ˆè¿”å›reså³å¯
- [å®˜æ–¹é¢˜è§£](https://leetcode.cn/problems/bricks-falling-when-hit/solution/803-da-zhuan-kuai-by-leetcode-r5kf/)å¾ˆè¯¦ç»†ï¼Œå¯ä»¥æŸ¥çœ‹
- è¸©çš„å‘å°±æ˜¯ï¼Œä¸€å®šè¦å®šä¹‰getSize()å‡½æ•°ï¼Œæˆ‘å¼€å§‹å°è¯•ç”¨roofä¸€ç›´ä½œä¸ºæ ¹ç»“ç‚¹ï¼Œåæ¥å‘ç°æ²¡åŠæ³•å…¨é¢è€ƒè™‘ï¼Œæ€»ä¼šæœ‰æƒ…å†µå¯¼è‡´æ ¹ç»“ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œè‡´ä½¿æœ€ç»ˆç»“æœå‡ºé”™ã€‚getSize()å‡½æ•°å¯ä»¥ä¿è¯ä¸€å®šæ˜¯è¿”å›äº†ç¥–å®—ç»“ç‚¹çš„sizeå€¼

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    int row, col;
    vector<int> parent, size;
    vector<pair<int, int>> directions{{0, 1}, {0, -1}, {1, 0}, {-1, 0}};

    int getIndex(int i, int j){
        return i * col + j;
    }

    bool inGrid(int i, int j){
        return i >= 0 && i < row && j >= 0 && j < col;
    }

    void initUnion(int len){
        parent.resize(len);
        size.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
            size[i] = 1;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){
        int pa = find(a), pb = find(b);
        if(pa == pb){
            return;
        }
        parent[pb] = pa;
        size[pa] += size[pb];
    }

    int getSize(int x){ // å¾ˆé‡è¦ï¼Œå› ä¸ºæœ‰å¯èƒ½æ ¹ç»“ç‚¹ä¼šå˜æˆå…¶ä»–çš„ç‚¹ï¼Œä½†åŒºé—´æ€»å’Œä¸ä¼šå˜
        return size[find(x)];
    }

    vector<int> hitBricks(vector<vector<int>>& grid, vector<vector<int>>& hits) {
        vector<int> res;
        row = grid.size();
        col = grid[0].size();
        int tempGrid[row][col];
        int length = hits.size();
        int roof = row * col;

        // åˆå§‹åŒ–tempGridï¼Œå°†éœ€è¦å‡»ç¢çš„åœ°æ–¹å˜ä¸º0
        for(int i = 0; i < row; i ++){ // å°†gridèµ‹ç»™tempGrid
            for(int j = 0; j < col; j ++){
                tempGrid[i][j] = grid[i][j];
            }
        }
        for(int i = 0; i < length; i ++){ // å°†å¯¹åº”ä½ç½®å˜ä¸º0
            tempGrid[hits[i][0]][hits[i][1]] = 0;
        }

        // å»ºç«‹å¹¶æŸ¥é›†å¹¶åˆå§‹åŒ–
        initUnion(roof + 1); // å¤šå‡ºæ¥çš„ä¸€ä¸ªç©ºé—´ç»™å±‹é¡¶ï¼Œå±‹é¡¶ä¸ºä¸€ä¸ªæ•´ä½“
        for(int i = 0; i < col; i ++){
            if(tempGrid[0][i] == 1){ // å°†æœ€ä¸Šé¢çš„ç –å—å’Œå±‹é¡¶æ”¾å…¥ä¸€ä¸ªå­åŒºé—´
                merge(roof, i);
            }
        }
        for(int i = 1; i < row; i ++){ // å¯¹äºå…¶ä½™ç –å—ï¼Œåˆ¤æ–­ä¸Šè¾¹å’Œå·¦è¾¹æ˜¯å¦ä¸ºç –å—
            for(int j = 0; j < col; j ++){
                if(tempGrid[i][j] == 1){
                    if(tempGrid[i - 1][j] == 1){
                        merge(getIndex(i - 1, j), getIndex(i, j));
                    }
                    if(j > 0 && tempGrid[i][j - 1] == 1){
                        merge(getIndex(i, j - 1), getIndex(i, j));
                    }
                }
            }
        }
        
        // ä¸æ–­æ·»åŠ ç –å—ï¼Œä¿®æ”¹è¿”å›å€¼
        for(int i = length - 1; i >= 0; i --){
            int x = hits[i][0], y = hits[i][1]; // æ‹¿åˆ°åæ ‡
            if(grid[x][y] == 1){
                int tempSize = getSize(roof);
                
                if(x == 0){ // æŠŠä¸Šæ–¹æ˜¯å±‹é¡¶çš„æƒ…å†µå…ˆåˆ¤æ–­äº†
                    merge(roof, y);
                }
                for(const auto& dir: directions){
                    // è·å–æ–°çš„ç‚¹
                    int newx = x + dir.first, newy = y + dir.second;
                    // åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼šæ˜¯å¦åœ¨çŸ©é˜µå†… && æ˜¯å¦æ˜¯ç –å—
                    if(inGrid(newx, newy) && tempGrid[newx][newy] == 1){
                        merge(getIndex(newx, newy), getIndex(x, y));
                    }
                }
                
                
                int nowSize = getSize(roof);
                res.push_back(max(0, nowSize - tempSize - 1));
                tempGrid[x][y] = 1;
            }
            else{
                res.push_back(0);
            }
        }

        reverse(res.begin(), res.end());
        return res;
    }
};
```



### 924. å°½é‡å‡å°‘æ¶æ„è½¯ä»¶çš„ä¼ æ’­ <span id="924"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªç”± `n` ä¸ªèŠ‚ç‚¹ç»„æˆçš„ç½‘ç»œï¼Œç”¨ `n x n` ä¸ªé‚»æ¥çŸ©é˜µ `graph` è¡¨ç¤ºã€‚åœ¨èŠ‚ç‚¹ç½‘ç»œä¸­ï¼Œåªæœ‰å½“ `graph[i][j] =1` æ—¶ï¼ŒèŠ‚ç‚¹ `i` èƒ½å¤Ÿç›´æ¥è¿æ¥åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ `j`ã€‚

ä¸€äº›èŠ‚ç‚¹ `initial` æœ€åˆè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ã€‚åªè¦ä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥è¿æ¥ï¼Œä¸”å…¶ä¸­è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹å—åˆ°æ¶æ„è½¯ä»¶çš„æ„ŸæŸ“ï¼Œé‚£ä¹ˆä¸¤ä¸ªèŠ‚ç‚¹éƒ½å°†è¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ã€‚è¿™ç§æ¶æ„è½¯ä»¶çš„ä¼ æ’­å°†ç»§ç»­ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„èŠ‚ç‚¹å¯ä»¥è¢«è¿™ç§æ–¹å¼æ„ŸæŸ“ã€‚

å‡è®¾ `M(initial)` æ˜¯åœ¨æ¶æ„è½¯ä»¶åœæ­¢ä¼ æ’­ä¹‹åï¼Œæ•´ä¸ªç½‘ç»œä¸­æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„æœ€ç»ˆèŠ‚ç‚¹æ•°ã€‚

å¦‚æœä» `initial` ä¸­**ç§»é™¤æŸä¸€èŠ‚ç‚¹**èƒ½å¤Ÿæœ€å°åŒ– `M(initial)`ï¼Œ è¿”å›è¯¥èŠ‚ç‚¹ã€‚å¦‚æœæœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³æ¡ä»¶ï¼Œå°±è¿”å›**ç´¢å¼•æœ€å°**çš„èŠ‚ç‚¹ã€‚**

è¯·æ³¨æ„ï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹å·²ä»å—æ„ŸæŸ“èŠ‚ç‚¹çš„åˆ—è¡¨ `initial` ä¸­åˆ é™¤ï¼Œå®ƒä»¥åä»æœ‰å¯èƒ½å› æ¶æ„è½¯ä»¶ä¼ æ’­è€Œå—åˆ°æ„ŸæŸ“ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šgraph = [[1,1,0],[1,1,0],[0,0,1]], initial = [0,1]
è¾“å‡ºï¼š0
```

```
è¾“å…¥ï¼šgraph = [[1,0,0],[0,1,0],[0,0,1]], initial = [0,2]
è¾“å‡ºï¼š0
```

```
è¾“å…¥ï¼šgraph = [[1,1,1],[1,1,1],[1,1,1]], initial = [1,2]
è¾“å‡ºï¼š1
```

**æç¤ºï¼š**

- `n == graph.length`
- `n == graph[i].length`
- `2 <= n <= 300`
- `graph[i][j]` æ˜¯ `0` æˆ– `1`.
- `graph[i][j] == graph[j][i]`
- `graph[i][i] == 1`
- `1 <= initial.length < n`
- `0 <= initial[i] <= n - 1`
- `initial` ä¸­æ¯ä¸ªæ•´æ•°éƒ½**ä¸åŒ**

**è§£é¢˜æ€è·¯ï¼š**

- é¦–å…ˆå»ºç«‹å¹¶æŸ¥é›†ï¼Œåˆå¹¶ç›¸è¿æ¥ç‚¹
- å¯¹äºæ¯ä¸ªæ±¡æŸ“ç‚¹æ¥è¯´ï¼Œç»Ÿè®¡å…¶æ‰€åœ¨å­åŒºé—´ä¸­çš„æ±¡æŸ“ç‚¹ä¸ªæ•°
- å¦‚æœï¼Œè¯¥åŒºé—´æ±¡æŸ“ç‚¹ä¸ªæ•°å¤§äº`1`ï¼Œåˆ™åˆ é™¤æ±¡æŸ“ç‚¹æ— æ„ä¹‰
  - å› ä¸ºåªèƒ½åˆ é™¤ä¸€ä¸ªæ±¡æŸ“ç‚¹ï¼Œè€Œåˆ é™¤åï¼Œè¯¥åŒºé—´ä¾ç„¶ä¼šè¢«å…¶ä»–ç‚¹æ±¡æŸ“

- åä¹‹ï¼Œæ±¡æŸ“ç‚¹ä¸ªæ•°ä¸º`1`ï¼Œåˆ™å¯ä»¥åˆ é™¤
- æœ€ç»ˆè¿”å›`res`

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent,size;
    void initUnion(int len){
        parent.resize(len);
        size.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
            size[i] = 1;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){
        int pa = find(a), pb = find(b);
        if(pa == pb){
            return;
        }
        parent[pb] = pa;
        size[pa] += size[pb];
    }

    int getSize(int x){
        return size[find(x)];
    }

    int minMalwareSpread(vector<vector<int>>& graph, vector<int>& initial) {
        int n = graph.size();
        initUnion(n);

        for(int i = 0; i < n; i ++){ // åˆå¹¶æ‰€æœ‰çš„ç›¸è¿ç‚¹
            for(int j = 0; j < n; j ++){
                if(graph[i][j] == 1){
                    merge(i, j);
                }
            }
        }

        vector<int> count(n, 0); 

        for(int dirty: initial){ // ç»Ÿè®¡ï¼Œæ¯ä¸ªæ±¡æŸ“ç‚¹æ‰€åœ¨çš„å­åŒºé—´å†…ï¼Œæœ‰å¤šå°‘ä¸ªæ±¡æŸ“ç‚¹
            count[find(dirty)] ++;
        }

        int tempSize = -1, res = -1;
        for(int dirty: initial){
            int pdirty = find(dirty);
            if(count[pdirty] == 1){ // å¦‚æœè¯¥åŒºé—´å†…ï¼Œæ±¡æŸ“ç‚¹å¤§äº1ä¸ªï¼Œåˆ™åˆ é™¤æ— æ„ä¹‰
                int tempSize1 = size[pdirty];
                if(tempSize1 > tempSize || (tempSize1 == tempSize && dirty < res)){
                    tempSize = tempSize1;
                    res = dirty;
                }
            }
        }

        if(res == -1){ // å¦‚æœæ‰€æœ‰çš„æ±¡æŸ“ç‚¹åˆ é™¤å‡æ— æ„ä¹‰ï¼Œå°±è¿”å›æœ€å°ç‚¹
            res = *min_element(initial.begin(), initial.end());
        }

        return res;
    }
};
```



### 928. å°½é‡å‡å°‘æ¶æ„è½¯ä»¶çš„ä¼ æ’­II <span id="928"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªç”± `n` ä¸ªèŠ‚ç‚¹ç»„æˆçš„ç½‘ç»œï¼Œç”¨ `n x n` ä¸ªé‚»æ¥çŸ©é˜µ `graph` è¡¨ç¤ºã€‚åœ¨èŠ‚ç‚¹ç½‘ç»œä¸­ï¼Œåªæœ‰å½“ `graph[i][j] =1` æ—¶ï¼ŒèŠ‚ç‚¹ `i` èƒ½å¤Ÿç›´æ¥è¿æ¥åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ `j`ã€‚

ä¸€äº›èŠ‚ç‚¹ `initial` æœ€åˆè¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ã€‚åªè¦ä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥è¿æ¥ï¼Œä¸”å…¶ä¸­è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹å—åˆ°æ¶æ„è½¯ä»¶çš„æ„ŸæŸ“ï¼Œé‚£ä¹ˆä¸¤ä¸ªèŠ‚ç‚¹éƒ½å°†è¢«æ¶æ„è½¯ä»¶æ„ŸæŸ“ã€‚è¿™ç§æ¶æ„è½¯ä»¶çš„ä¼ æ’­å°†ç»§ç»­ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„èŠ‚ç‚¹å¯ä»¥è¢«è¿™ç§æ–¹å¼æ„ŸæŸ“ã€‚

å‡è®¾ `M(initial)` æ˜¯åœ¨æ¶æ„è½¯ä»¶åœæ­¢ä¼ æ’­ä¹‹åï¼Œæ•´ä¸ªç½‘ç»œä¸­æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„æœ€ç»ˆèŠ‚ç‚¹æ•°ã€‚

æˆ‘ä»¬å¯ä»¥ä» `initial` ä¸­**åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹**ï¼Œ**å¹¶å®Œå…¨ç§»é™¤è¯¥èŠ‚ç‚¹ä»¥åŠä»è¯¥èŠ‚ç‚¹åˆ°ä»»ä½•å…¶ä»–èŠ‚ç‚¹çš„ä»»ä½•è¿æ¥ã€‚**

è¯·è¿”å›ç§»é™¤åèƒ½å¤Ÿä½¿ `M(initial)` æœ€å°åŒ–çš„èŠ‚ç‚¹ã€‚å¦‚æœæœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³æ¡ä»¶ï¼Œè¿”å›ç´¢å¼• **æœ€å°çš„èŠ‚ç‚¹** ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å‡ºï¼šgraph = [[1,1,0],[1,1,0],[0,0,1]], initial = [0,1]
è¾“å…¥ï¼š0
```

```
è¾“å…¥ï¼šgraph = [[1,1,0],[1,1,1],[0,1,1]], initial = [0,1]
è¾“å‡ºï¼š1
```

```
è¾“å…¥ï¼šgraph = [[1,1,0,0],[1,1,1,0],[0,1,1,1],[0,0,1,1]], initial = [0,1]
è¾“å‡ºï¼š1
```

**æç¤ºï¼š**

- `n == graph.length`
- `n == graph[i].length`
- `2 <= n <= 300`
- `graph[i][j]` æ˜¯ `0` æˆ– `1`.
- `graph[i][j] == graph[j][i]`
- `graph[i][i] == 1`
- `1 <= initial.length < n`
- `0 <= initial[i] <= n - 1`
-  `initial` ä¸­æ¯ä¸ªæ•´æ•°éƒ½**ä¸åŒ**

**è§£é¢˜æ€è·¯ï¼š**

- å’Œ 924é¢˜ çš„åŒºåˆ«åœ¨äº
  - æœ¬é¢˜å®Œå…¨åˆ é™¤äº†æ‰€æœ‰è¿æ¥ï¼Œå¯è§†ä¸ºè¯¥ç‚¹ä¸å­˜åœ¨
  - è€Œ924é¢˜åªæ˜¯å°†åˆå§‹çŠ¶æ€æ”¹ä¸ºæœªæ±¡æŸ“ï¼Œåç»­ä¾ç„¶å¯ä»¥è¿›å…¥æ•´ä½“çš„é€»è¾‘æ“ä½œä¸­
  - å› æ­¤ï¼Œ924å¯ä»¥ç›´æ¥è¿æ¥æ‰€æœ‰ç›¸è¿ç‚¹ï¼Œç»Ÿè®¡æ¯ä¸ªæ±¡æŸ“ç‚¹æ‰€åœ¨åŒºé—´çš„å¤§å°
  - è€Œå¯¹äºæœ¬é¢˜ï¼Œå®Œå…¨åˆ é™¤ç»“ç‚¹æœ‰å¯èƒ½å°†å¤§åŒºé—´åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå› æ­¤åªèƒ½å¯¹æœªæ±¡æŸ“ç‚¹å»ºç«‹å­åŒºé—´

- é¦–å…ˆå¯¹åˆå§‹çš„æœªæ±¡æŸ“ç‚¹æ„å»ºå¹¶æŸ¥é›†ï¼Œå°†æœªæ±¡æŸ“ç‚¹åˆå¹¶ä¸ºå¤šä¸ªå­åŒºé—´
- å¯¹äºåˆ é™¤æ±¡æŸ“ç‚¹
  - å¦‚æœä¸€ä¸ªå­åŒºé—´å’Œå¤šä¸ªæ±¡æŸ“ç‚¹ç›¸è¿ï¼Œé‚£åˆ é™¤æ±¡æŸ“ç‚¹æ˜¯æ— æ„ä¹‰çš„ã€‚åˆ äº†ä¸€ä¸ªï¼Œå…¶ä»–æ±¡æŸ“ç‚¹ä¾ç„¶å¯ä»¥å°†åŒºé—´å†…çš„æ‰€æœ‰ç‚¹éƒ½æ±¡æŸ“äº†
  - å¦‚æœä¸€ä¸ªå­åŒºé—´åªå’Œä¸€ä¸ªæ±¡æŸ“ç‚¹ç›¸è¿ï¼Œé‚£ä¹ˆåˆ é™¤è¯¥æ±¡æŸ“ç‚¹åï¼Œè¯¥åŒºé—´å°±éƒ½å¯ä»¥å¹¸å­˜ï¼Œå¯ä»¥å‡å°‘`M(initial)`
- å› æ­¤æˆ‘ä»¬ç»Ÿè®¡å¯¹äºæ¯ä¸ªæ±¡æŸ“ç‚¹ï¼Œå¯ä»¥åˆ°è¾¾çš„æ‰€æœ‰æœªæ±¡æŸ“å­åŒºé—´ï¼Œå³`graph[dirty][clean] = 1`ï¼Œè·å¾—`find(clean)`
- å°†æ‰€æœ‰åŒºé—´çš„ç¥–å®—ç»“ç‚¹æ”¾å…¥åŒä¸€ä¸ª`set`ä¸­ï¼Œå¹¶å’Œå¯¹åº”çš„æ±¡æŸ“ç‚¹å‹å…¥`map`ä¸­ï¼Œæ„æˆ`key-value`
- åŒæ—¶æˆ‘ä»¬è¦ç»Ÿè®¡å¯¹äºæ‰€æœ‰çš„ç¥–å®—ç»“ç‚¹ï¼Œæœ‰å¤šå°‘æ±¡æŸ“ç‚¹å¯ä»¥åˆ°è¾¾å®ƒä»¬ï¼Œä¹Ÿå°±æ˜¯`count[i]`
- æœ€åï¼Œéå†`map`ï¼Œå–å‡ºæ±¡æŸ“ç‚¹å’Œ`set`ï¼Œåˆ¤æ–­èƒ½å¦ç§»é™¤å½“å‰æ±¡æŸ“ç‚¹ï¼Œè®¡ç®—`tempSize`å’Œ`res`

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent, size;
    void initUnion(int len){
        parent.resize(len);
        size.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
            size[i] = 1;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    int getSize(int x){
        return size[find(x)];
    }

    void merge(int a, int b){
        int pa = find(a), pb = find(b);
        if(pa == pb){
            return;
        }
        parent[pb] = pa;
        size[pa] += size[pb];
    }

    int minMalwareSpread(vector<vector<int>>& graph, vector<int>& initial) {
        int n = graph.size();

        initUnion(n);

        // ç¬¬ä¸€æ­¥ï¼Œå°†åˆå§‹æ²¡æœ‰è¢«æ±¡æŸ“çš„ç‚¹å»ºç«‹å¹¶æŸ¥é›†
        vector<int> cleanNode(n, 1); // æœªæ±¡æŸ“ç‚¹ï¼Œåˆå§‹å€¼ä¸º1
        for(int num: initial){ // å°†è¢«æ±¡æŸ“ç‚¹çš„å¯¹åº”ä½ç½®å˜ä¸º0
            cleanNode[num] = 0;
        }
        for(int i = 0; i < n; i ++){ // åˆå¹¶æœªæ±¡æŸ“åŒºé—´
            if(cleanNode[i] == 1){
                for(int j = 0; j < n; j ++){
                    if(cleanNode[j] == 1 && graph[i][j] == 1){
                        merge(i, j);
                    }
                }
            }
        }

        // ç¬¬äºŒæ­¥ï¼Œç»Ÿè®¡æ¯ä¸ªæ±¡æŸ“ç‚¹å¯ä»¥åˆ°è¾¾çš„æœªæ±¡æŸ“ç‚¹åŒºé—´;å¹¶è®°å½•æ¯ä¸ªæœªæ±¡æŸ“åŒºé—´å¯ä»¥è¢«å¤šå°‘æ±¡æŸ“ç‚¹åˆ°è¾¾
        vector<int> count(n, 0); // å¯åˆ°è¾¾æœªæ±¡æŸ“åŒºé—´çš„æ±¡æŸ“ç‚¹ä¸ªæ•°ï¼Œåˆå§‹å€¼ä¸º0
        map<int, set<int>> dirtyToClean; // æ±¡æŸ“ç‚¹åˆ°æœªæ±¡æŸ“åŒºé—´çš„map
        for(int dirty: initial){ // éå†æ±¡æŸ“ç‚¹
            set<int> toClean;
            for(int clean = 0; clean < n; clean ++){ // è®°å½•è¯¥æ±¡æŸ“ç‚¹å¯ä»¥åˆ°è¾¾çš„æœªæ±¡æŸ“åŒºé—´
                if(cleanNode[clean] == 1 && graph[dirty][clean] == 1){
                    toClean.insert(find(clean));
                }
            }

            dirtyToClean.insert({dirty, toClean}); // å°†æ±¡æŸ“ç‚¹å’Œå¯¹åº”çš„å¯åˆ°è¾¾åŒºé—´å‹å…¥map

            for(int clean :toClean){ // ç»Ÿè®¡å¯åˆ°è¾¾çš„ä¸ªæ•°
                count[clean]++;
            }
        }

        // ç¬¬ä¸‰æ­¥ï¼Œæ‰¾åˆ°åªèƒ½è¢«ä¸€ä¸ªæ±¡æŸ“ç‚¹åˆ°è¾¾çš„æœªæ±¡æŸ“åŒºé—´ï¼Œè¯¥æ±¡æŸ“ç‚¹åˆ é™¤åï¼Œæ•´ä¸ªåŒºé—´éƒ½èƒ½å¤Ÿä¸è¢«æ±¡æŸ“
        int tempSize = -1,  res = -1;
        for(auto iter : dirtyToClean) { // éå†æ‰€æœ‰æ±¡æŸ“ç‚¹å’Œå¯åˆ°è¾¾çš„æœªæ±¡æŸ“åŒºé—´
            set<int> toClean = iter.second;
            int tempSize1 = 0;
            for(int clean: toClean){
                if(count[clean] == 1){ // å¦‚æœè¯¥åŒºé—´åªæœ‰ä¸€ä¸ªæ±¡æŸ“ç‚¹å¯ä»¥åˆ°è¾¾ï¼Œåˆ™åˆ é™¤æ±¡æŸ“ç‚¹æœ‰æ„ä¹‰
                    tempSize1 += getSize(clean);
                }
            }

            if(tempSize1 > tempSize || (tempSize1 == tempSize && iter.first < res)){ // åˆ¤æ–­tempsizeå’Œres
                tempSize = tempSize1;
                res = iter.first;
            }
        }

        return res;
    }
};
```



### 952. æŒ‰å…¬å› æ•°è®¡ç®—æœ€å¤§ç»„ä»¶å¤§å° <span id="952"></span>

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªç”±ä¸åŒæ­£æ•´æ•°çš„ç»„æˆçš„éç©ºæ•°ç»„ `nums` ï¼Œè€ƒè™‘ä¸‹é¢çš„å›¾ï¼š

- æœ‰ `nums.length` ä¸ªèŠ‚ç‚¹ï¼ŒæŒ‰ä» `nums[0]` åˆ° `nums[nums.length - 1]` æ ‡è®°ï¼›
- åªæœ‰å½“ `nums[i]` å’Œ `nums[j]` å…±ç”¨ä¸€ä¸ªå¤§äº 1 çš„å…¬å› æ•°æ—¶ï¼Œ`nums[i]` å’Œ `nums[j]`ä¹‹é—´æ‰æœ‰ä¸€æ¡è¾¹ã€‚

è¿”å› *å›¾ä¸­æœ€å¤§è¿é€šç»„ä»¶çš„å¤§å°* ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šnums = [4,6,15,35]
è¾“å‡ºï¼š4
```

```
è¾“å…¥ï¼šnums = [20,50,9,63]
è¾“å‡ºï¼š2
```

```
è¾“å…¥ï¼šnums = [2,3,6,7,4,12,21,39]
è¾“å‡ºï¼š8
```

**æç¤ºï¼š**

- `1 <= nums.length <= 2 * 104`
- `1 <= nums[i] <= 105`
- `nums` ä¸­æ‰€æœ‰å€¼éƒ½ **ä¸åŒ**

**è§£é¢˜æ€è·¯ï¼š**

- å¯¹nums[i]ä¸Šé™å®šä¹‰å¹¶æŸ¥é›†ï¼Œå³å¤§å°ä¸º100001
- é€šè¿‡åŸƒå¼ç­›æ³•ç­›é€‰å‡ºåœ¨nums[i]èŒƒå›´å†…çš„æ‰€æœ‰ç´ æ•°
  - ç”¨è¿™äº›ç´ æ•°æ¥æ‰¾å‡ºnums[i]èŒƒå›´å†…æ‰€æœ‰çš„åˆæ•°
  - å°†å¯¹åº”ç´ æ•°å’Œæ‰¾åˆ°çš„åˆæ•°è¿›è¡ŒåŒºé—´åˆå¹¶
  - è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¯¥ç´ æ•°æ²¡æœ‰å‡ºç°åœ¨numsä¸­ï¼Œé‚£ä¹ˆè¦å°†size[i]å˜ä¸º0ï¼Œé˜²æ­¢å½±å“æœ€ç»ˆç»“æœä¸ªæ•°
- æœ€åä»numsä¸­æ‰¾åˆ°æ‹¥æœ‰æœ€å¤šå…ƒç´ çš„å­åŒºé—´å¹¶è¿”å›ä¸ªæ•°
- ä¸èƒ½é‡‡ç”¨çº¿æ€§ç­›æ³•ï¼Œå› ä¸ºå¯¹äºçº¿æ€§ç­›æ³•ï¼Œæ¯ä¸ªæ•°åªè¢«å®ƒçš„æœ€å°è´¨å› å­ç­›æ‰ï¼Œä¸ä¼šå‡ºç°é‡å¤ç­›é™¤çš„æƒ…å†µï¼Œå¯¼è‡´æœ¬æ¥åº”è¯¥åˆå¹¶çš„åŒºé—´æ²¡æœ‰åˆå¹¶ï¼Œå½±å“æœ€ç»ˆç»“æœ

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent, size;

    void initUnion(int len){
        parent.resize(len);
        size.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
            size[i] = 1;
        }
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    int getSize(int x){
        return size[find(x)];
    }

    void merge(int a, int b){
        int pa = find(a), pb = find(b);
        if(pa == pb){
            return;
        }
        parent[pb] = pa;
        size[pa] += size[pb];
    }

    int largestComponentSize(vector<int>& nums) {
        initUnion(100001); // åˆå§‹åŒ–å¹¶æŸ¥é›†

        vector<int> prime(100001, 1); // åˆå§‹åŒ–ç´ æ•°
        set<int> s;
        for(int i = 0; i < nums.size(); i ++){ // å°†numsæ”¾å…¥sä¸­ï¼Œæ–¹ä¾¿åç»­åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¹¶å–å‡ºæœ€å¤§å€¼
            s.insert(nums[i]);
        }
        int top = *s.rbegin(); // è·å¾—æœ€å¤§å€¼
        for(int i = 2; i <= top; i++){
            if(prime[i]){
                if(!s.count(i)){ // å¦‚æœè¯¥ç´ æ•°åœ¨sä¸­ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¦å°†sizeå˜ä¸º0ï¼Œå¦åˆ™ä¼šåœ¨æœ€ç»ˆçš„getSizeä¸­åŠ ä¸Šä¸å­˜åœ¨çš„ç´ æ•°ä¸ªæ•°
                    size[i] = 0;
                }

                for (int j = i + i; j <= top; j += i){ // åªå¯¹ç´ æ•°ç­›å€æ•°ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦
                    prime[j] = 0;
                    if(s.count(j)){ // å¦‚æœè¯¥åˆæ•°å­˜åœ¨ï¼Œåˆå¹¶å­åŒºé—´
                        merge(i, j);
                    }
                }   
            }
        }

        int res = 0;
        for(int num:nums){ // æ‰¾åˆ°æœ€å¤§çš„å­åŒºé—´
            res = max(res, getSize(num));
        }

        return res;
    }
};
```



### 959. ç”±æ–œæ åˆ’åˆ†åŒºåŸŸ <span id="959"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ffa119>ä¸­ç­‰</font>

**é¢˜ç›®ï¼š**

åœ¨ç”± `1 x 1` æ–¹æ ¼ç»„æˆçš„ `n x n` ç½‘æ ¼ `grid` ä¸­ï¼Œæ¯ä¸ª `1 x 1` æ–¹å—ç”± `'/'`ã€`'\'` æˆ–ç©ºæ ¼æ„æˆã€‚è¿™äº›å­—ç¬¦ä¼šå°†æ–¹å—åˆ’åˆ†ä¸ºä¸€äº›å…±è¾¹çš„åŒºåŸŸã€‚

ç»™å®šç½‘æ ¼ `grid` è¡¨ç¤ºä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè¿”å› *åŒºåŸŸçš„æ•°é‡* ã€‚

è¯·æ³¨æ„ï¼Œåæ–œæ å­—ç¬¦æ˜¯è½¬ä¹‰çš„ï¼Œå› æ­¤ `'\'` ç”¨ `'\\'` è¡¨ç¤ºã€‚

**ç¤ºä¾‹ï¼š**

![ç”±æ–œæ åˆ’åˆ†åŒºåŸŸ å›¾æºLeetCode](https://store.southyang.cn/LeetCode/UnionFind/959(1).png)

```
è¾“å…¥ï¼šgrid = [" /","/ "]
è¾“å‡ºï¼š2
```
![ç”±æ–œæ åˆ’åˆ†åŒºåŸŸ å›¾æºLeetCode](https://store.southyang.cn/LeetCode/UnionFind/959(2).png)
```
è¾“å…¥ï¼šgrid = [" /","  "]
è¾“å‡ºï¼š1
```
![ç”±æ–œæ åˆ’åˆ†åŒºåŸŸ å›¾æºLeetCode](https://store.southyang.cn/LeetCode/UnionFind/959(3).png)
```
è¾“å…¥ï¼šgrid = ["/\\","\\/"]
è¾“å‡ºï¼š5
è§£é‡Šï¼šå›æƒ³ä¸€ä¸‹ï¼Œå› ä¸º \ å­—ç¬¦æ˜¯è½¬ä¹‰çš„ï¼Œæ‰€ä»¥ "/\\" è¡¨ç¤º /\ï¼Œè€Œ "\\/" è¡¨ç¤º \/ã€‚
```

**æç¤ºï¼š**

- `n == grid.length == grid[i].length`
- `1 <= n <= 30`
- `grid[i][j]` æ˜¯ `'/'`ã€`'\'`ã€æˆ– `' '`

**è§£é¢˜æ€è·¯ï¼š**

- å°†æ¯ä¸ªå…ƒç´ çœ‹åšä¸€ä¸ªæ­£æ–¹å½¢ï¼Œæ­£æ–¹å½¢å¯ä»¥ç”±å››ä¸ªä¸‰è§’å½¢ç»„æˆï¼›è€Œæ–œæ å¯ä»¥å°†å››ä¸ªä¸‰è§’å½¢åˆ’åˆ†ä¸ºä¸¤ä¸ªå­åŒºé—´
- ä»è€Œæˆ‘ä»¬æ„å»º 4 * n * n çš„å¹¶æŸ¥é›†ï¼Œå°è¯•å°†æ¯ä¸ªä¸‰è§’å½¢æ‰€åœ¨åŒºé—´è¿›è¡Œåˆå¹¶
- æ­£æ–¹å½¢å†…éƒ¨åˆå¹¶
  - å¦‚æœ`grid[i][j] = '/'`ï¼Œåˆ™åˆå¹¶ä¸‰è§’å½¢ 0 3ã€1 2 ä¸ºä¸¤ä¸ªå­åŒºé—´
  - å¦‚æœ`grid[i][j] = '\\'`ï¼Œåˆ™åˆå¹¶ä¸‰è§’å½¢ 0 1ã€2 3 ä¸ºä¸¤ä¸ªå­åŒºé—´
  - å¦‚æœ`grid[i][j] = ' '`ï¼Œåˆ™å››ä¸ªä¸‰è§’å½¢åˆå¹¶ä¸ºä¸€ä¸ªå­åŒºé—´
- æ­£æ–¹å½¢ä¹‹é—´åˆå¹¶
  - æ¯ä¸ªæ­£æ–¹å½¢éƒ½ä¸å³è¾¹ã€ä¸‹è¾¹çš„æ­£æ–¹å½¢è¿›è¡ŒåŒºé—´åˆå¹¶
  - å’Œå³è¾¹ï¼šåˆå¹¶ 1 3
  - å’Œä¸‹è¾¹ï¼šåˆå¹¶ 2 0
- æœ€ç»ˆåˆ¤æ–­å¹¶æŸ¥é›†ä¸­åŒºé—´æ•°é‡å³å¯

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    vector<int> parent;
    int count;

    void initUnion(int len){
        parent.resize(len);
        for(int i = 0; i < len; i ++){
            parent[i] = i;
        }
        count = len;
    }

    int find(int x){
        if(x != parent[x]){
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    void merge(int a, int b){
        int pa = find(a), pb = find(b);
        if(pa == pb){
            return;
        }
        parent[pb] = pa;
        count --;
    }

    int regionsBySlashes(vector<string>& grid) {
        int length = grid.size();
        initUnion(4 * length * length);

        for(int i = 0; i < length; i ++){
            string& temp = grid[i];
            for(int j = 0; j < length; j ++){
                int index = 4 * ( i * length + j); // æ¯ä¸ªæ­£æ–¹å½¢å†…ï¼Œåºå·ä¸º0çš„ä¸‰è§’å½¢ä¸‹æ ‡

                // æ­£æ–¹å½¢å†…éƒ¨åˆå¹¶
                if(temp[j] == '/'){
                    merge(index, index + 3);
                    merge(index + 1, index + 2);
                }
                else if(temp[j] == '\\'){
                    merge(index, index + 1);
                    merge(index + 2, index + 3);
                }
                else{
                    merge(index, index + 1);
                    merge(index, index + 2);
                    merge(index, index + 3);
                }

                // æ­£æ–¹å½¢ä¹‹é—´åˆå¹¶
                if(j + 1 < length){ // å‘å³åˆå¹¶,1 å’Œ 3
                    merge(index + 1, index + 7);
                }
                if(i + 1 < length){ // å‘ä¸‹åˆå¹¶,2 å’Œ 0
                    merge(index + 2, 4 * ( (i + 1) * length + j));
                }
            }
        }

        return count;
    }
};
```
