---
title: Backtracking
date: 2022-04-18 20:11:48
permalink: /pages/31b21a/
---
# å›æº¯

## ç±»å‹

**æ ‡äº†ğŸŒŸçš„æ˜¯æŒ‰ç…§å®˜æ–¹é¢˜è§£å†™çš„**



## é¢˜ç›®

### 37. è§£æ•°ç‹¬ <span id="37"></span> ğŸŒŸ

**éš¾åº¦ï¼š**<font color=#ef4743>å›°éš¾</font>

**é¢˜ç›®ï¼š**

ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œé€šè¿‡å¡«å……ç©ºæ ¼æ¥è§£å†³æ•°ç‹¬é—®é¢˜ã€‚

æ•°ç‹¬çš„è§£æ³•éœ€ **éµå¾ªå¦‚ä¸‹è§„åˆ™**ï¼š

1. æ•°å­— `1-9` åœ¨æ¯ä¸€è¡Œåªèƒ½å‡ºç°ä¸€æ¬¡ã€‚
2. æ•°å­— `1-9` åœ¨æ¯ä¸€åˆ—åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚
3. æ•°å­— `1-9` åœ¨æ¯ä¸€ä¸ªä»¥ç²—å®çº¿åˆ†éš”çš„ `3x3` å®«å†…åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚ï¼ˆè¯·å‚è€ƒç¤ºä¾‹å›¾ï¼‰

æ•°ç‹¬éƒ¨åˆ†ç©ºæ ¼å†…å·²å¡«å…¥äº†æ•°å­—ï¼Œç©ºç™½æ ¼ç”¨ `'.'` è¡¨ç¤ºã€‚

**ç¤ºä¾‹ï¼š**

![è§£æ•°ç‹¬ å›¾æºLeetCode](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2021/04/12/250px-sudoku-by-l2g-20050714svg.png)

```
è¾“å…¥ï¼šboard = [["5","3",".",".","7",".",".",".","."],
["6",".",".","1","9","5",".",".","."],
[".","9","8",".",".",".",".","6","."],
["8",".",".",".","6",".",".",".","3"],
["4",".",".","8",".","3",".",".","1"],
["7",".",".",".","2",".",".",".","6"],
[".","6",".",".",".",".","2","8","."],
[".",".",".","4","1","9",".",".","5"],
[".",".",".",".","8",".",".","7","9"]]
è¾“å‡ºï¼š[["5","3","4","6","7","8","9","1","2"],
["6","7","2","1","9","5","3","4","8"],
["1","9","8","3","4","2","5","6","7"],
["8","5","9","7","6","1","4","2","3"],
["4","2","6","8","5","3","7","9","1"],
["7","1","3","9","2","4","8","5","6"],
["9","6","1","5","3","7","2","8","4"],
["2","8","7","4","1","9","6","3","5"],
["3","4","5","2","8","6","1","7","9"]]
è§£é‡Šï¼šè¾“å…¥çš„æ•°ç‹¬å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå”¯ä¸€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹æ‰€ç¤ºï¼š
```

![è§£æ•°ç‹¬ç¤ºä¾‹ å›¾æºLeetCode](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2021/04/12/250px-sudoku-by-l2g-20050714_solutionsvg.png)

**æç¤ºï¼š**

- `board.length == 9`
- `board[i].length == 9`
- `board[i][j]` æ˜¯ä¸€ä½æ•°å­—æˆ–è€… `'.'`
- é¢˜ç›®æ•°æ® **ä¿è¯** è¾“å…¥æ•°ç‹¬ä»…æœ‰ä¸€ä¸ªè§£

**è§£é¢˜æ€è·¯ï¼š**

- è§£æ•°ç‹¬ç›¸å½“äºä¸€ä¸ªå¯ä»¥ä¸èµ°åˆ°å°½å¤´çš„dfs
- å¯¹äºå¸¸è§„çš„dfsé¢˜ç›®ï¼Œæˆ‘ä»¬éœ€è¦å°†æ‰€æœ‰å¯èƒ½çš„æƒ…å†µéå†ä¸€æ¬¡ï¼Œæ‰¾å…¨æ’åˆ—
- è€Œå¯¹äºè§£æ•°ç‹¬ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºä¸€ç§è§£æ³•å°±å¯ä»¥äº†ï¼Œå› æ­¤éœ€è¦ç»´æŠ¤ä¸€ä¸ªnotcontinueæ¥åˆ¤æ–­æ˜¯å¦è·³å‡ºå¾ªç¯
- é¢˜ç›®è¦ä»ä¸‰æ–¹é¢åˆ¤æ–­æ˜¯å¦å¯ç”¨ï¼Œå³ï¼š
  - å½“å‰è¡Œæ˜¯å¦å¯ç”¨æ•°å­—xï¼Œå³`line[i][x]`æ˜¯å¦ä¸ºfalse
  - å½“å‰åˆ—æ˜¯å¦å¯ç”¨æ•°å­—xï¼Œå³`column[j][x]`æ˜¯å¦ä¸ºfalse
  - å½“å‰ä¹å®«æ ¼æ˜¯å¦å¯ç”¨æ•°å­—xï¼Œå³`block[i/3][j/3][x]`æ˜¯å¦ä¸ºfalse
- å› æ­¤æ¯æ¬¡éƒ½éœ€è¦åˆ¤æ–­ä¸‰ç§æƒ…å†µï¼š`if(!line[i][k] && !column[j][k] && !block[i / 3][j / 3][k])`
- å‰©ä¸‹çš„å°±æ˜¯ä¼ ç»Ÿdfsçš„å†…å®¹äº†

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    bool line[9][9]; // è®°å½•è¡Œä¸­æ•°å­—æ˜¯å¦å¯å­˜æ”¾
    bool column[9][9]; // è®°å½•åˆ—ä¸­æ•°å­—æ˜¯å¦å¯å­˜æ”¾
    bool block[3][3][9]; // è®°å½•ä¹å®«æ ¼å†…æ•°å­—æ˜¯å¦å¯å­˜æ”¾
    bool notcontinue; // è®°å½•æ˜¯å¦éœ€è¦ç»§ç»­éå†
    vector<pair<int,int>> emptyspaces; // è®°å½•éœ€è¦å­˜æ”¾æ•°å­—çš„åœ°æ–¹

    void dfs(vector<vector<char>>& board, int depth){
        if(depth == emptyspaces.size()){ // å¦‚æœå°†éœ€è¦å­˜æ”¾æ•°å­—çš„åœ°æ–¹éå†å®Œæˆï¼Œç»“æŸå¾ªç¯
            notcontinue = true;
            return;
        }

        auto [i, j] = emptyspaces[depth]; // è·å–æ•°å­—å­˜æ”¾åœ°ç‚¹
        for(int k = 0; k < 9 && !notcontinue; k ++){
            if(!line[i][k] && !column[j][k] && !block[i / 3][j / 3][k]){ // å¦‚æœå½“å‰ä½ç½®å¯ä»¥å­˜æ”¾
                line[i][k] = column[j][k] = block[i / 3][j / 3][k] = true; // ä¿®æ”¹çŠ¶æ€ä¸ºä¸å¯ç”¨
                board[i][j] = k + '0' + 1; // æ”¹å˜boardå¯¹åº”ä½ç½®
                dfs(board, depth + 1); // åœ¨å½“å‰ä¿®æ”¹çš„åŸºç¡€ä¸Šç»§ç»­dfs
                line[i][k] = column[j][k] = block[i / 3][j / 3][k] = false; // ä¿®æ”¹çŠ¶æ€ä¸ºå¯ç”¨
            }
        }
    }

    void solveSudoku(vector<vector<char>>& board) {
        for(int i = 0; i < board.size(); i ++){ // éå†boardå¾—åˆ°åˆå§‹çš„lineã€columnã€blockçŠ¶æ€
            for(int j = 0; j < board[0].size(); j ++){
                if(board[i][j] == '.'){
                    emptyspaces.push_back({i ,j});
                }
                else{
                    int temp = board[i][j] - '0' - 1;
                    line[i][temp] = column[j][temp] = block[i / 3][j / 3][temp] = true;
                }
            }
        }
        dfs(board, 0);
    }
};
```



### 46. å…¨æ’åˆ— <span id="46"></span>

**éš¾åº¦ï¼š**<font color=#ffa119>ä¸­ç­‰</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªä¸å«é‡å¤æ•°å­—çš„æ•°ç»„ `nums` ï¼Œè¿”å›å…¶ *æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—* ã€‚ä½ å¯ä»¥ **æŒ‰ä»»æ„é¡ºåº** è¿”å›ç­”æ¡ˆã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šnums = [1,2,3]
è¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]
```

```
è¾“å…¥ï¼šnums = [0,1]
è¾“å‡ºï¼š[[0,1],[1,0]]
```

```
è¾“å…¥ï¼šnums = [1]
è¾“å‡ºï¼š[[1]]
```

**æç¤ºï¼š**

- `1 <= nums.length <= 6`
- `-10 <= nums[i] <= 10`
- `nums` ä¸­çš„æ‰€æœ‰æ•´æ•° **äº’ä¸ç›¸åŒ**

**è§£é¢˜æ€è·¯ï¼š**

- ç›´æ¥æ·±åº¦ä¼˜å…ˆéå†ï¼Œèµ°åˆ°å¤´å°±å¾€å›èµ°ä¸€ä¸ªï¼Œç„¶åç»§ç»­å¾€ä¸‹èµ°
- è¦æ³¨æ„çš„æ˜¯æ ‡æ³¨æ•°æ®å¯ç”¨çŠ¶æ€

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    void dfs(int depth, vector<int>& nums, vector<bool>& status, vector<int>& temp, vector<vector<int> >& res){
        if(depth == nums.size()){ // å¦‚æœå…¨éƒ¨éå†ï¼Œå‹å…¥reså¹¶è¿”å›
            res.push_back(temp);
            return;
        }
        for(int i = 0; i < nums.size(); i ++){
            if(!status[i]){
            	temp.push_back(nums[i]); // å‹å…¥temp
            	status[i] = true; // æ”¹å˜çŠ¶æ€ä¸ºä¸å¯ç”¨

            	dfs(depth + 1, nums, status, temp, res); // å¯¹ä¸‹ä¸€ä¸ªä½ç½®è¿›è¡Œdfs

            	temp.pop_back(); // å¼¹å‡ºæœ«å°¾
            	status[i] = false; // æ”¹å˜çŠ¶æ€ä¸ºå¯ç”¨
	    	}
        }
    }

    vector<vector<int> > permute(vector<int>& nums) {
	    int len = nums.size();
        vector<vector<int> > res;
        vector<int> temp;
        vector<bool> status(len, false);
        dfs(0, nums, status, temp, res); // æ·±åº¦ï¼Œnumsæ•°æ®ï¼ŒstatusçŠ¶æ€æ•°ç»„ï¼Œtempä¸´æ—¶æ•°ç»„ï¼Œresè¿”å›æ•°ç»„
        return res;
    }
};
```



### 47. å…¨æ’åˆ—II <span id="47"></span>

**éš¾åº¦ï¼š**<font color=#ffa119>ä¸­ç­‰</font>

**é¢˜ç›®ï¼š**

ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— `nums` ï¼Œ***æŒ‰ä»»æ„é¡ºåº*** è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ã€‚

**ç¤ºä¾‹ï¼š**

```
è¾“å…¥ï¼šnums = [1,1,2]
è¾“å‡ºï¼š
[[1,1,2],
 [1,2,1],
 [2,1,1]]
```

```
è¾“å…¥ï¼šnums = [1,2,3]
è¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]
```

**æç¤ºï¼š**

- `1 <= nums.length <= 8`
- `-10 <= nums[i] <= 10`

**è§£é¢˜æ€è·¯ï¼š**

- å¤§ä½“æ€è·¯å’Œ46é¢˜æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å¢åŠ äº†ä¸€ä¸ªå»é‡çš„åˆ¤æ–­
- è€ƒè™‘å¦‚ä½•å»é‡
  - åŒä¸€ä¸ªä½ç½®ï¼Œç›¸åŒçš„å…ƒç´ åªèƒ½è®°å½•ä¸€æ¬¡ï¼Œè®°å½•ä¸¤æ¬¡åˆ™æœ‰é‡å¤
  - ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬è¦è®°å½•å½“å‰ä½ç½®çš„å¼¹å‡ºæ•°æ®è®°å½•ä¸‹æ¥
  - å¦‚æœæˆ‘ä»¬è®°å½•æ‰€æœ‰çš„å¼¹å‡ºæ•°æ®ï¼Œéœ€è¦é¢å¤–çš„ç©ºé—´O(n)æ¥ä¿å­˜
  - ç”¨æ—¶é—´æ¢ç©ºé—´ï¼šå¯¹numsæ•°ç»„æ’åºï¼Œè¿™æ ·é‡å¤æ•°æ®å°±ä¼šæŒ¨ç€å‡ºç°ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªå¸¸æ•°ç©ºé—´å°±å¯ä»¥è®°å½•å¼¹å‡ºæ•°æ®

**ä»£ç ï¼š**

```cpp
class Solution {
public:
    void dfs(int depth, vector<int>& nums, vector<bool>& status, vector<int>& temp, vector<vector<int> >& res){
        if(depth == nums.size()){ // å¦‚æœå…¨éƒ¨éå†ï¼Œå‹å…¥reså¹¶è¿”å›
            res.push_back(temp);
            return;
        }
        int out = 20; // è®°å½•ä¸€ä¸ªæ•°æ®èŒƒå›´ä¹‹å¤–çš„æ•°ä½œä¸ºout
        for(int i = 0; i < nums.size(); i ++){
            if(!status[i] && nums[i] != out){ // å¦‚æœå½“å‰è¦å‹å…¥çš„æ•°å’Œåˆšå¼¹å‡ºçš„æ•°ç›¸åŒï¼Œåˆ™ä¸èƒ½å‹å…¥
                temp.push_back(nums[i]); // å‹å…¥temp
                status[i] = true; // æ”¹å˜çŠ¶æ€ä¸ºä¸å¯ç”¨

                dfs(depth + 1, nums, status, temp, res);

                out = temp.back(); // å–å‡ºæœ€åä¸€ä¸ªæ•°æ®
                temp.pop_back(); // å¼¹å‡ºæœ«å°¾
                status[i] = false; // æ”¹å˜çŠ¶æ€ä¸ºå¯ç”¨
            }
        }
    }
    vector<vector<int>> permuteUnique(vector<int>& nums) {
        int len = nums.size();
        sort(nums.begin(), nums.end());
        vector<int> temp;
        vector<vector<int>> res;
        vector<bool> status(len, false);
        dfs(0, nums, status, temp, res); // æ·±åº¦ï¼Œnumsæ•°æ®ï¼ŒstatusçŠ¶æ€æ•°ç»„ï¼Œtempä¸´æ—¶æ•°ç»„ï¼Œresè¿”å›æ•°ç»„
        return res;
    }
};
```

